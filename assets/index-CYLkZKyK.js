import{r as et,a as tt,g as st}from"./vendor-react-DFjkEYJa.js";import{r as d,a as at,R as Pe,b as ve,B as rt,C as nt,X as lt,Y as ot,T as je,c as Ee,P as Ce,d as Ie,e as De}from"./vendor-recharts-6XH8ZDyn.js";import"./vendor-utils-B-dksMZM.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))p(i);new MutationObserver(i=>{for(const x of i)if(x.type==="childList")for(const l of x.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&p(l)}).observe(document,{childList:!0,subtree:!0});function c(i){const x={};return i.integrity&&(x.integrity=i.integrity),i.referrerPolicy&&(x.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?x.credentials="include":i.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function p(i){if(i.ep)return;i.ep=!0;const x=c(i);fetch(i.href,x)}})();var we={exports:{}},ae={};var Ae;function it(){if(Ae)return ae;Ae=1;var t=et(),u=Symbol.for("react.element"),c=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function l(g,m,b){var w,r={},a=null,n=null;b!==void 0&&(a=""+b),m.key!==void 0&&(a=""+m.key),m.ref!==void 0&&(n=m.ref);for(w in m)p.call(m,w)&&!x.hasOwnProperty(w)&&(r[w]=m[w]);if(g&&g.defaultProps)for(w in m=g.defaultProps,m)r[w]===void 0&&(r[w]=m[w]);return{$$typeof:u,type:g,key:a,ref:n,props:r,_owner:i.current}}return ae.Fragment=c,ae.jsx=l,ae.jsxs=l,ae}var Re;function ct(){return Re||(Re=1,we.exports=it()),we.exports}var e=ct(),ue={},Te;function dt(){if(Te)return ue;Te=1;var t=tt();return ue.createRoot=t.createRoot,ue.hydrateRoot=t.hydrateRoot,ue}var xt=dt();const ut=st(xt);var se=(t=>(t.USD="USD",t.EUR="EUR",t.GBP="GBP",t.JPY="JPY",t.CAD="CAD",t.AUD="AUD",t.INR="INR",t.CNY="CNY",t))(se||{}),I=(t=>(t.INCOME="income",t.EXPENSE="expense",t))(I||{}),O=(t=>(t.FOOD="Food",t.TRANSPORT="Transport",t.HOUSING="Housing",t.UTILITIES="Utilities",t.ENTERTAINMENT="Entertainment",t.HEALTH="Health",t.INCOME="Salary",t.SHOPPING="Shopping",t.SAVINGS="Savings",t.GOAL="Goal",t.RENTAL="Rental",t.FREELANCE="Freelance",t.BONUS="Bonus",t.INVESTMENTS="Investments",t.REFUNDS="Refunds",t.GIFT="Gift",t.FIXED_RETURN_INVESTMENT="Fixed-Yield Asset",t.OTHER="Other",t))(O||{}),K=(t=>(t.WEEKLY="Weekly",t.MONTHLY="Monthly",t.YEARLY="Yearly",t))(K||{});const mt=1e5,ht=16,ye=12;class pt{constructor(){this.key=null}async deriveKey(u,c){const p=new TextEncoder,i=await window.crypto.subtle.importKey("raw",p.encode(u),{name:"PBKDF2"},!1,["deriveKey"]),x=c||window.crypto.getRandomValues(new Uint8Array(ht)),l=await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:x,iterations:mt,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]);return this.key=l,{key:l,salt:x}}hasKey(){return this.key!==null}clearKey(){this.key=null}async encrypt(u){if(!this.key)throw new Error("Key not initialized");const c=new TextEncoder,p=window.crypto.getRandomValues(new Uint8Array(ye)),i=c.encode(u),x=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:p},this.key,i),l=new Uint8Array(p.byteLength+x.byteLength);return l.set(p,0),l.set(new Uint8Array(x),p.byteLength),this.arrayBufferToBase64(l)}async decrypt(u){if(!this.key)throw new Error("Key not initialized");const c=this.base64ToArrayBuffer(u),p=c.slice(0,ye),i=c.slice(ye),x=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:p},this.key,i);return new TextDecoder().decode(x)}arrayBufferToBase64(u){let c="";const p=u.byteLength;for(let i=0;i<p;i++)c+=String.fromCharCode(u[i]);return window.btoa(c)}base64ToArrayBuffer(u){const c=window.atob(u),p=c.length,i=new Uint8Array(p);for(let x=0;x<p;x++)i[x]=c.charCodeAt(x);return i}}const X=new pt,Le="vf_rates_cache",bt=1e3*60*60*24,ft=async t=>{const u=localStorage.getItem(Le);if(u)try{const c=JSON.parse(u),p=Date.now()-c.timestamp<bt,i=c.base===t;if(p&&i)return c.rates}catch{}try{const c=await fetch(`https://open.er-api.com/v6/latest/${t}`);if(!c.ok)throw new Error("Failed to fetch rates");const i=(await c.json()).rates,x={timestamp:Date.now(),base:t,rates:i};return localStorage.setItem(Le,JSON.stringify(x)),i}catch{return u?JSON.parse(u).rates:{[t]:1}}},me=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),ee=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M12 5v14"})]}),ce=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),he=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),e.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),ie=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("line",{x1:"8",x2:"21",y1:"6",y2:"6"}),e.jsx("line",{x1:"8",x2:"21",y1:"12",y2:"12"}),e.jsx("line",{x1:"8",x2:"21",y1:"18",y2:"18"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"18",y2:"18"})]}),gt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Me=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),Ne=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"m17 2 4 4-4 4"}),e.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),e.jsx("path",{d:"m7 22-4-4 4-4"}),e.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]}),pe=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),vt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),Ue=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),Oe=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),e.jsx("path",{d:"M21 3v5h-5"}),e.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),e.jsx("path",{d:"M3 21v-5h5"})]}),Be=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),jt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"}),e.jsx("rect",{width:"20",height:"14",x:"2",y:"6",rx:"2"})]}),wt=({children:t,content:u,position:c="bottom"})=>{const[p,i]=d.useState(!1),x=d.useRef(null),[l,g]=d.useState({left:0,top:0});return d.useEffect(()=>{if(x.current){const m=x.current.getBoundingClientRect(),b=window.scrollY,w=window.scrollX;let r=0,a=m.left+m.width/2+w;c==="top"?r=m.top+b-12:r=m.bottom+b+12,g({top:r,left:a})}},[p,c]),u?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:x,className:"relative inline-block",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:t}),at.createPortal(e.jsx("div",{className:`tooltip-custom ${p?"visible":""}`,style:{top:l.top,left:l.left},children:u}),document.body)]}):e.jsx(e.Fragment,{children:t})},yt="modulepreload",Nt=function(t){return"/vault_finance/"+t},Fe={},kt=function(u,c,p){let i=Promise.resolve();if(c&&c.length>0){let m=function(b){return Promise.all(b.map(w=>Promise.resolve(w).then(r=>({status:"fulfilled",value:r}),r=>({status:"rejected",reason:r}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),g=l?.nonce||l?.getAttribute("nonce");i=m(c.map(b=>{if(b=Nt(b),b in Fe)return;Fe[b]=!0;const w=b.endsWith(".css"),r=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${b}"]${r}`))return;const a=document.createElement("link");if(a.rel=w?"stylesheet":yt,w||(a.as="script"),a.crossOrigin="",a.href=b,g&&a.setAttribute("nonce",g),document.head.appendChild(a),w)return new Promise((n,k)=>{a.addEventListener("load",n),a.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${b}`)))})}))}function x(l){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=l,window.dispatchEvent(g),!g.defaultPrevented)throw l}return i.then(l=>{for(const g of l||[])g.status==="rejected"&&x(g.reason);return u().catch(x)})};function St(t={}){const{immediate:u=!1,onNeedRefresh:c,onOfflineReady:p,onRegistered:i,onRegisteredSW:x,onRegisterError:l}=t;let g,m,b;const w=async(a=!0)=>{await m,b?.()};async function r(){if("serviceWorker"in navigator){if(g=await kt(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:a}},[]).then(({Workbox:a})=>new a("/vault_finance/sw.js",{scope:"/vault_finance/",type:"classic"})).catch(a=>{l?.(a)}),!g)return;b=()=>{g?.messageSkipWaiting()};{let a=!1;const n=()=>{a=!0,g?.addEventListener("controlling",k=>{k.isUpdate&&window.location.reload()}),c?.()};g.addEventListener("installed",k=>{typeof k.isUpdate>"u"?typeof k.isExternal<"u"&&k.isExternal?n():!a&&p?.():k.isUpdate||p?.()}),g.addEventListener("waiting",n)}g.register({immediate:u}).then(a=>{x?x("/vault_finance/sw.js",a):i?.(a)}).catch(a=>{l?.(a)})}}return m=r(),w}function Et(t={}){const{immediate:u=!0,onNeedRefresh:c,onOfflineReady:p,onRegistered:i,onRegisteredSW:x,onRegisterError:l}=t,[g,m]=d.useState(!1),[b,w]=d.useState(!1),[r]=d.useState(()=>St({immediate:u,onOfflineReady(){w(!0),p?.()},onNeedRefresh(){m(!0),c?.()},onRegistered:i,onRegisteredSW:x,onRegisterError:l}));return{needRefresh:[g,m],offlineReady:[b,w],updateServiceWorker:r}}const q="vf_encrypted_vault",J="vf_salt",le="vf_vault_name",ke=300*1e3,$e=["#f87171","#fbbf24","#f472b6","#a78bfa","#f97316","#e11d48","#c084fc"],_e=["#34d399","#60a5fa","#2dd4bf","#818cf8","#4ade80","#22d3ee","#6366f1"],te=[O.INCOME,O.SAVINGS,O.RENTAL,O.FREELANCE,O.BONUS,O.INVESTMENTS,O.REFUNDS,O.GIFT,O.OTHER],re={transactions:[],recurring:[],goals:[],baseCurrency:se.USD,theme:"dark",autoLockDuration:ke,customCategories:[]},Z=(t,u)=>{const c=Math.abs(t)>=1e3;return new Intl.NumberFormat(void 0,{style:"currency",currency:u,notation:c?"compact":"standard",maximumFractionDigits:c?3:2,minimumFractionDigits:c?0:2}).format(t)},G=t=>{const u=Math.abs(t)>=1e3;return new Intl.NumberFormat(void 0,{notation:u?"compact":"standard",maximumFractionDigits:u?3:2,minimumFractionDigits:u?0:2}).format(t)},oe=t=>isNaN(t)?"1.0000":new Intl.NumberFormat(void 0,{maximumFractionDigits:4,minimumFractionDigits:2}).format(t);function Ct(){const[t,u]=d.useState(!!localStorage.getItem(J)),[c,p]=d.useState(!1),[i,x]=d.useState(""),[l,g]=d.useState(!1),[m,b]=d.useState(null),[w,r]=d.useState(localStorage.getItem(le)||""),[a,n]=d.useState(re),[k,F]=d.useState({}),[y,s]=d.useState("dashboard"),[E,T]=d.useState(!1),[D,j]=d.useState(null),[P,S]=d.useState(!1),[M,U]=d.useState(navigator.onLine),H=d.useRef(null),[h,C]=d.useState(!1),[L,A]=d.useState(null),{needRefresh:[$],updateServiceWorker:_}=Et({onRegistered(o){o&&(H.current=o,setInterval(()=>{o.update()},3600*1e3))},onRegisterError(o){}}),z=d.useRef($);d.useEffect(()=>{z.current=$},[$]);const de=async()=>{if(!(!M||h)){if($){_(!0);return}C(!0),A("Checking...");try{if(H.current){await H.current.update();let o=0;const v=setInterval(()=>{z.current&&(clearInterval(v),C(!1),A("New Update Available!")),o++,o>=6&&(clearInterval(v),C(!1),z.current||(A("Up to date!"),setTimeout(()=>A(null),3e3)))},500)}else C(!1),A("Ready"),setTimeout(()=>A(null),2e3)}catch{C(!1),A("Failed"),setTimeout(()=>A(null),3e3)}}};d.useEffect(()=>{const o=()=>U(!0),v=()=>U(!1);return window.addEventListener("online",o),window.addEventListener("offline",v),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",v)}},[]);const Y=d.useRef(Date.now());d.useEffect(()=>{if(!c)return;const o=a.autoLockDuration!==void 0?a.autoLockDuration:ke;if(o===0)return;const v=()=>{Date.now()-Y.current>o&&be()},f=()=>{Y.current=Date.now()},N=setInterval(v,1e4);return window.addEventListener("mousemove",f),window.addEventListener("keydown",f),window.addEventListener("click",f),()=>{clearInterval(N),window.removeEventListener("mousemove",f),window.removeEventListener("keydown",f),window.removeEventListener("click",f)}},[c,a.autoLockDuration]);const Ge=async(o,v,f)=>{if(o.preventDefault(),b(null),f.length<4){b("Password is too short (min 4 chars).");return}if(v.length>21){b("Vault Name must be 21 characters or less.");return}g(!0);try{const{salt:N}=await X.deriveKey(f),B=btoa(String.fromCharCode(...N));localStorage.setItem(J,B),v&&(localStorage.setItem(le,v),r(v));const R={...re,vaultName:v},W=JSON.stringify(R),fe=await X.encrypt(W);localStorage.setItem(q,fe),n(R),u(!0),p(!0),x("")}catch{b("Failed to create vault.")}finally{g(!1)}},He=o=>{new Date().setHours(0,0,0,0),(o.recurring||[]).forEach(N=>{if(!N.active)return;new Date(N.nextDueDate).setHours(0,0,0,0)})},ze=async o=>{o.preventDefault(),g(!0),b(null);try{const v=localStorage.getItem(J),f=localStorage.getItem(q);if(!v){u(!1);return}const N=new Uint8Array(atob(v).split("").map(B=>B.charCodeAt(0)));if(await X.deriveKey(i,N),f)try{const B=await X.decrypt(f),R=JSON.parse(B);let W=!1;const fe=R.transactions.map(ge=>ge.recordedBaseCurrency?ge:(W=!0,{...ge,recordedBaseCurrency:R.baseCurrency}));R.recurring||(R.recurring=[],W=!0),R.goals||(R.goals=[],W=!0),R.autoLockDuration===void 0&&(R.autoLockDuration=ke,W=!0),R.customCategories||(R.customCategories=[],W=!0),W&&(R.transactions=fe,Se(R)),R.vaultName&&R.vaultName!==w&&(localStorage.setItem(le,R.vaultName),r(R.vaultName)),n(R),p(!0),He(R)}catch{b("Incorrect password.")}else n(re),p(!0)}catch{b("An error occurred during authentication.")}finally{g(!1),x("")}},be=()=>{X.clearKey(),p(!1),x(""),n(re),s("dashboard")},Ye=()=>{localStorage.clear(),X.clearKey(),n(re),p(!1),u(!1),x(""),r(""),s("dashboard")},Se=async o=>{try{const v=JSON.stringify(o),f=await X.encrypt(v);localStorage.setItem(q,f)}catch{alert("Failed to save data securely!")}},Q=o=>{n(o),Se(o)};d.useEffect(()=>{c&&(async()=>{const v=await ft(a.baseCurrency);F(v)})()},[c,a.baseCurrency]);const xe=d.useCallback((o,v,f)=>{if(v===f||!k[v]&&!k[f])return o;if(f===a.baseCurrency){const R=k[v];return R?o/R:o}if(v===a.baseCurrency){const R=k[f];return R?o*R:o}const N=k[v],B=k[f];return!N||!B?o:o/N*B},[k,a.baseCurrency]),V=d.useCallback(o=>{if(o.exchangeRate&&o.recordedBaseCurrency){const v=o.amount/o.exchangeRate;return xe(v,o.recordedBaseCurrency,a.baseCurrency)}return xe(o.amount,o.currency,a.baseCurrency)},[a.baseCurrency,xe]),We=d.useMemo(()=>a.transactions.reduce((o,v)=>{const f=V(v);return o+(v.type===I.INCOME?f:-f)},0),[a.transactions,V]),Ke=d.useMemo(()=>{const o=a.transactions.filter(f=>f.type===I.EXPENSE),v={};return o.forEach(f=>{const N=V(f);v[f.category]=(v[f.category]||0)+N}),Object.entries(v).sort((f,N)=>N[1]-f[1]).map(([f,N])=>({name:f,value:N}))},[a.transactions,V]),Xe=d.useMemo(()=>{const o=a.transactions.filter(f=>f.type===I.INCOME),v={};return o.forEach(f=>{const N=V(f);v[f.category]=(v[f.category]||0)+N}),Object.entries(v).sort((f,N)=>N[1]-f[1]).map(([f,N])=>({name:f,value:N}))},[a.transactions,V]),qe=d.useMemo(()=>a.transactions.filter(o=>o.type===I.INCOME).reduce((o,v)=>o+V(v),0),[a.transactions,V]),Je=d.useMemo(()=>a.transactions.filter(o=>o.type===I.EXPENSE).reduce((o,v)=>o+V(v),0),[a.transactions,V]),Qe=d.useMemo(()=>a.transactions.filter(o=>o.type===I.EXPENSE&&(o.category===O.FIXED_RETURN_INVESTMENT||o.category==="Capital Asset"||o.category==="Fixed Return Investment")).reduce((o,v)=>o+V(v),0),[a.transactions,V]),Ze=d.useMemo(()=>{const o={},v=new Date;for(let f=5;f>=0;f--){const B=new Date(v.getFullYear(),v.getMonth()-f,1).toLocaleString("default",{month:"short"});o[B]={income:0,expense:0}}return a.transactions.forEach(f=>{const N=new Date(f.date);if(v.getTime()-N.getTime()<4320*60*60*1e3){const B=N.toLocaleString("default",{month:"short"});if(o[B]){const R=V(f);f.type===I.INCOME?o[B].income+=R:o[B].expense+=R}}}),Object.entries(o).map(([f,N])=>({name:f,Income:N.income,Expense:N.expense}))},[a.transactions,V]);return t?c?e.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col md:flex-row text-slate-200 font-sans",children:[e.jsxs("aside",{className:"hidden md:flex flex-col w-64 border-r border-slate-800 bg-slate-950 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10 px-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-xl shadow-lg shadow-brand-500/20",children:e.jsx(me,{className:"w-6 h-6 text-white"})}),e.jsxs("span",{className:"font-bold text-lg tracking-tight text-white flex flex-col leading-tight min-w-0",children:[e.jsx("span",{children:"Vault Finance"}),e.jsx("span",{className:"text-xs text-brand-400 font-mono font-medium tracking-wider cursor-default",children:"v1.0.0"})]})]}),e.jsxs("nav",{className:"flex-1 space-y-2",children:[e.jsx(ne,{active:y==="dashboard",onClick:()=>s("dashboard"),icon:e.jsx(he,{}),label:"Dashboard"}),e.jsx(ne,{active:y==="transactions",onClick:()=>s("transactions"),icon:e.jsx(ie,{}),label:"Transactions"}),e.jsx(ne,{active:y==="recurring",onClick:()=>s("recurring"),icon:e.jsx(Ne,{}),label:"Recurring"}),e.jsx(ne,{active:y==="goals",onClick:()=>s("goals"),icon:e.jsx(pe,{}),label:"Goals"}),e.jsx(ne,{active:y==="settings",onClick:()=>s("settings"),icon:e.jsx(gt,{}),label:"Settings"})]}),e.jsxs("div",{className:"mt-auto space-y-2 pt-6 border-t border-slate-800",children:[e.jsxs("button",{onClick:de,disabled:!M||h,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 border text-sm font-medium ${$?"bg-brand-600 border-brand-500 text-white shadow-lg animate-pulse":"bg-transparent border-transparent text-slate-500 hover:text-slate-300 hover:bg-slate-900/50"} disabled:opacity-30 disabled:cursor-not-allowed`,children:[e.jsx(Oe,{className:`w-5 h-5 ${$||h?"animate-spin-slow":""}`}),e.jsx("span",{className:"truncate",children:$?"Apply Update":L||"Check Updates"}),!M&&e.jsx("span",{className:"text-[10px] ml-auto opacity-50",children:"Offline"})]}),e.jsxs("button",{onClick:be,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 border border-transparent text-sm font-medium text-slate-500 hover:text-white hover:bg-slate-900/50",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{children:"Lock Vault"})]})]})]}),e.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-slate-800 bg-slate-950/80 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-lg",children:e.jsx(me,{className:"w-5 h-5 text-white"})}),e.jsxs("span",{className:"font-bold text-lg text-white flex flex-col leading-tight min-w-0",children:[e.jsx("span",{children:"Vault Finance"}),e.jsx("span",{className:"text-xs text-brand-400 font-mono font-medium tracking-wider cursor-default",children:"v1.0.0"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[L&&!$&&e.jsx("span",{className:"text-[10px] font-bold text-brand-400 animate-in fade-in zoom-in-95",children:L}),e.jsx("button",{onClick:de,disabled:!M||h,className:`p-2 rounded-lg transition-all ${$?"bg-brand-600 text-white animate-pulse":"text-slate-500 hover:text-white hover:bg-slate-900"} disabled:opacity-30 disabled:cursor-not-allowed`,title:M?$?"Click to Update!":L||"Check for Updates":"Offline",children:e.jsx(Oe,{className:`w-5 h-5 ${$||h?"animate-spin-slow":""}`})}),e.jsx("button",{onClick:be,className:"text-slate-500 hover:text-white p-2",children:e.jsx(Me,{className:"w-5 h-5"})})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto h-screen relative scrollbar-hide bg-slate-950",children:e.jsxs("div",{className:"p-6 max-w-6xl mx-auto pb-24 md:pb-6 relative z-10",children:[y==="dashboard"&&e.jsx(At,{balance:We,totalIncome:qe,totalExpense:Je,totalHoldings:Qe,baseCurrency:a.baseCurrency,expensesByCategory:Ke,incomeByCategory:Xe,monthlyData:Ze,recentTransactions:a.transactions.slice(0,5),onAddTransaction:()=>{j(null),T(!0)},onViewAll:()=>s("transactions")}),y==="transactions"&&e.jsx(Rt,{transactions:a.transactions,baseCurrency:a.baseCurrency,onDelete:o=>{const v=a.transactions.find(N=>N.id===o);let f=a.goals;v?.goalId&&(f=a.goals.map(N=>N.id===v.goalId?{...N,currentAmount:Math.max(0,N.currentAmount-v.amount)}:N)),Q({...a,transactions:a.transactions.filter(N=>N.id!==o),goals:f})},onEdit:o=>{j(o),T(!0)},onAdd:()=>{j(null),T(!0)},getTransactionValue:V,customCategories:a.customCategories}),y==="recurring"&&e.jsx(Tt,{data:a,onUpdate:Q,baseCurrency:a.baseCurrency,exchangeRates:k}),y==="goals"&&e.jsx(Lt,{data:a,onUpdate:Q,baseCurrency:a.baseCurrency,convertAmount:xe,exchangeRates:k}),y==="settings"&&e.jsx(Mt,{data:a,onUpdateData:Q,onVaultDeleted:()=>{u(!1),p(!1),localStorage.clear()},exchangeRates:k})]})}),e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-slate-950 border-t border-slate-800 flex justify-around p-4 z-20 pb-8",children:[e.jsx("button",{onClick:()=>s("dashboard"),className:`${y==="dashboard"?"text-white":"text-slate-500"}`,children:e.jsx(he,{})}),e.jsx("button",{onClick:()=>s("transactions"),className:`${y==="transactions"?"text-white":"text-slate-500"}`,children:e.jsx(ie,{})}),e.jsx("button",{onClick:()=>{j(null),T(!0)},className:"bg-brand-600 text-white p-3 rounded-full -mt-10 border-4 border-slate-950 shadow-lg shadow-brand-900/40",children:e.jsx(ee,{})}),e.jsx("button",{onClick:()=>s("recurring"),className:`${y==="recurring"?"text-white":"text-slate-500"}`,children:e.jsx(Ne,{})}),e.jsx("button",{onClick:()=>s("goals"),className:`${y==="goals"?"text-white":"text-slate-500"}`,children:e.jsx(pe,{})})]}),E&&e.jsx(Ot,{initialData:D,onClose:()=>{T(!1),j(null)},onSave:o=>{if(D){let v=a.goals;if(o.goalId){const f=o.amount-D.amount;v=a.goals.map(N=>N.id===o.goalId?{...N,currentAmount:Math.max(0,N.currentAmount+f)}:N)}Q({...a,transactions:a.transactions.map(f=>f.id===o.id?o:f),goals:v})}else Q({...a,transactions:[o,...a.transactions]});T(!1),j(null)},baseCurrency:a.baseCurrency,exchangeRates:k,customCategories:a.customCategories})]}):e.jsxs("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 inset-0 bg-gradient-to-b from-slate-900 to-slate-950"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-brand-900/10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl relative z-10 animate-in fade-in zoom-in-95 duration-500",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-brand-600 rounded-2xl shadow-lg shadow-brand-500/20",children:e.jsx(me,{className:"w-10 h-10 text-white"})})}),e.jsx("div",{className:"flex justify-center mb-2",children:w?e.jsx("h1",{className:"text-2xl font-bold text-center text-white truncate max-w-[300px]",children:w}):e.jsx("h1",{className:"text-2xl font-bold text-center text-white",children:"Vault Locked"})}),e.jsx("p",{className:"text-slate-400 text-center mb-8 text-sm",children:w?"Enter your master password to access your vault.":"Enter your master password to decrypt."}),e.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{type:"password",value:i,onChange:o=>x(o.target.value),placeholder:"Master Password",className:"w-full bg-slate-950 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 focus:border-transparent transition-all placeholder:text-slate-600",autoFocus:!0})}),m&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-900/20 py-2 rounded-lg border border-red-900/50",children:m}),e.jsx("button",{type:"submit",disabled:!i||l,className:"w-full bg-brand-600 hover:bg-brand-500 text-white font-semibold py-3 rounded-xl transition-all shadow-lg shadow-brand-600/20 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center",children:l?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"Unlock Vault"})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-slate-800 text-center",children:e.jsx("button",{onClick:()=>S(!0),className:"text-xs text-slate-500 hover:text-red-400 transition-colors",children:"Reset Vault (Delete Data)"})}),P&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-8 w-full max-w-sm shadow-2xl animate-in zoom-in-95 duration-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-red-500/10 rounded-2xl",children:e.jsx(ce,{className:"w-8 h-8 text-red-500"})})}),e.jsx("h3",{className:"text-xl font-bold text-white text-center mb-2",children:"Reset Entire Vault?"}),e.jsxs("p",{className:"text-slate-400 text-sm text-center mb-8",children:["This will perform a hard reset. All your data will be"," ",e.jsx("strong",{children:"permanently deleted"}),". This action cannot be undone."]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{Ye(),S(!1)},className:"w-full bg-red-600 hover:bg-red-500 text-white py-3.5 rounded-xl font-bold transition-all shadow-lg shadow-red-600/20",children:"Yes, Delete Everything"}),e.jsx("button",{onClick:()=>S(!1),className:"w-full bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-xl font-medium transition-colors",children:"Cancel"})]})]})})]})]}):e.jsx(It,{password:i,setPassword:x,onCreate:Ge,isLoading:l,error:m,onImportSuccess:()=>{u(!0),r(localStorage.getItem(le)||"")}})}const It=({password:t,setPassword:u,onCreate:c,isLoading:p,error:i,onImportSuccess:x})=>{const[l,g]=d.useState("create"),[m,b]=d.useState(null),w=r=>{const a=r.target.files?.[0];if(b(null),!a)return;if(a.size===0){b("Import Failed: The selected file is empty."),r.target.value="";return}const n=new FileReader;n.onload=k=>{try{const F=(k.target?.result||"").trim();if(!F){b("Import Failed: File content is empty.");return}let y=!1;try{const s=JSON.parse(F);if(s.transactions&&Array.isArray(s.transactions)&&!s.salt){b("Security Error: Importing unencrypted raw JSON data is not allowed."),r.target.value="";return}s.salt&&s.data&&(localStorage.setItem(J,s.salt),localStorage.setItem(q,s.data),y=!0)}catch{}if(!y&&!m&&F.includes("|")){const s=F.split("|");if(s.length>=2){const[E,T]=s;E&&T&&(localStorage.setItem(J,E),localStorage.setItem(q,T),localStorage.setItem(J,E),localStorage.setItem(q,T),y=!0)}}y?x():m||b("Invalid backup file format. Expected an encrypted .vf file.")}catch{b("Import Failed: An unexpected error occurred.")}r.target.value=""},n.readAsText(a)};return e.jsxs("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 inset-0 bg-gradient-to-b from-slate-900 to-slate-950"}),e.jsxs("div",{className:"w-full max-w-lg bg-slate-900 border border-slate-800 rounded-3xl p-8 shadow-2xl relative z-10 animate-in fade-in slide-in-from-bottom-8 duration-500",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-2xl shadow-xl shadow-brand-500/20",children:e.jsx(me,{className:"w-12 h-12 text-white"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome to Vault Finance"}),e.jsx("p",{className:"text-slate-400",children:"Secure, offline, personal finance tracking."})]}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl mb-8 border border-slate-800",children:[e.jsx("button",{onClick:()=>{g("create"),b(null)},className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-all ${l==="create"?"bg-brand-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Create New Vault"}),e.jsx("button",{onClick:()=>{g("import"),b(null)},className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-all ${l==="import"?"bg-brand-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Import Backup"})]}),l==="create"?e.jsx(Dt,{onCreate:c,isLoading:p,error:i}):e.jsxs("div",{className:"animate-in fade-in duration-300 text-center py-8 bg-slate-950/50 rounded-2xl border border-slate-800 border-dashed",children:[e.jsx(ie,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white font-medium mb-1",children:"Upload Backup File"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Restore a .vf encrypted backup file."}),m&&e.jsx("div",{className:"mb-6 mx-4 p-3 bg-red-900/20 border border-red-900/50 rounded-xl text-sm text-red-400",children:m}),e.jsxs("label",{className:"bg-white hover:bg-slate-200 text-black px-6 py-3 rounded-xl font-bold cursor-pointer transition-all inline-block",children:["Select File",e.jsx("input",{type:"file",onChange:w,className:"hidden",accept:".json,.vf"})]})]})]})]})},Dt=({onCreate:t,isLoading:u,error:c})=>{const[p,i]=d.useState(""),[x,l]=d.useState(""),g=m=>{t(m,p,x)};return e.jsxs("form",{onSubmit:g,className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1.5 uppercase tracking-wider",children:"Vault Name"}),e.jsx("input",{type:"text",name:"username",value:p,maxLength:21,onChange:m=>i(m.target.value),className:"w-full bg-slate-900 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",placeholder:"e.g. My Vault",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1.5 uppercase tracking-wider",children:"Set Master Password"}),e.jsx("input",{type:"password",value:x,onChange:m=>l(m.target.value),placeholder:"Create a strong password",className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 focus:border-transparent transition-all placeholder:text-slate-600"}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Your data will be encrypted with this password."})]}),c&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-900/20 py-2 rounded-lg border border-red-900/50",children:c}),e.jsx("button",{type:"submit",disabled:!x||!p.trim()||u,className:"w-full bg-white hover:bg-slate-200 text-black font-bold py-3.5 rounded-xl transition-all shadow-lg mt-2 disabled:opacity-50",children:u?"Creating...":"Create Vault"})]})},ne=({active:t,onClick:u,icon:c,label:p})=>e.jsxs("button",{onClick:u,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 border text-sm font-medium ${t?"bg-slate-900 border-slate-800 text-white shadow-sm":"bg-transparent border-transparent text-slate-500 hover:text-slate-300 hover:bg-slate-900/50"}`,children:[Pe.cloneElement(c,{className:`w-5 h-5 ${t?"text-brand-400":"text-current"}`}),e.jsx("span",{className:"",children:p})]}),At=({balance:t,totalIncome:u,totalExpense:c,totalHoldings:p,baseCurrency:i,expensesByCategory:x,incomeByCategory:l,monthlyData:g,recentTransactions:m,onAddTransaction:b,onViewAll:w})=>e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-brand-600 to-indigo-700 rounded-3xl p-8 text-white border border-brand-500/20 relative overflow-hidden shadow-2xl shadow-brand-900/30 group transition-all duration-500 hover:scale-[1.01] hover:shadow-brand-900/50",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-32 group-hover:bg-white/15 transition-colors duration-500"}),e.jsx("p",{className:"text-brand-100 font-medium mb-2 relative z-10 text-sm uppercase tracking-wider flex items-center gap-2",children:"Total Balance"}),e.jsx("h2",{className:"text-4xl lg:text-5xl font-bold relative z-10 tracking-tight text-white drop-shadow-sm break-words leading-tight",children:Z(t,i)}),e.jsxs("button",{onClick:b,className:"mt-8 bg-white/10 hover:bg-white/20 backdrop-blur-md border border-white/20 py-2.5 px-5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 relative z-10 hover:scale-105 active:scale-95",children:[e.jsx(ee,{className:"w-4 h-4"})," Add Transaction"]}),e.jsxs("div",{className:"mt-8 grid grid-cols-2 gap-4 relative z-10 border-t border-white/10 pt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-brand-100/60 uppercase tracking-wider mb-1",children:"Income"}),e.jsx("span",{className:"text-lg font-bold text-emerald-300",children:Z(u,i)})]}),e.jsxs("div",{className:"flex flex-col border-l border-white/10 pl-4",children:[e.jsx("span",{className:"text-xs text-brand-100/60 uppercase tracking-wider mb-1",children:"Expenses"}),e.jsx("span",{className:"text-lg font-bold text-rose-300",children:Z(c,i)})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between bg-white/5 backdrop-blur-sm border border-white/10 rounded-2xl p-4 relative z-10 group/holdings hover:bg-white/10 transition-all cursor-default",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-amber-500/20 rounded-xl text-amber-400 group-hover/holdings:scale-110 transition-transform",children:e.jsx(jt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-brand-100/60 uppercase tracking-wider font-semibold",children:"Holdings"}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:"Investments"})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("span",{className:"text-xl font-bold text-amber-300 drop-shadow-sm",children:Z(p,i)})})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 text-slate-100 flex items-center gap-2",children:["Analytics"," ",e.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-950 px-2 py-0.5 rounded-full border border-slate-800",children:"Last 6 Months"})]}),e.jsx("div",{style:{width:"100%",height:300},children:e.jsx(ve,{width:"100%",height:"100%",children:e.jsxs(rt,{data:g,children:[e.jsx(nt,{strokeDasharray:"3 3",stroke:"#27272a",vertical:!1}),e.jsx(lt,{dataKey:"name",stroke:"#6b7280",tickLine:!1,axisLine:!1,fontSize:12,dy:10}),e.jsx(ot,{stroke:"#6b7280",tickLine:!1,axisLine:!1,fontSize:12,tickFormatter:r=>`${r/1e3}k`}),e.jsx(je,{formatter:r=>G(r),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},cursor:{fill:"rgba(255,255,255,0.03)"}}),e.jsx(Ee,{dataKey:"Income",fill:"#34d399",radius:[4,4,0,0],maxBarSize:40}),e.jsx(Ee,{dataKey:"Expense",fill:"#f87171",radius:[4,4,0,0],maxBarSize:40})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1.5fr_1fr] gap-6",children:[e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm flex flex-col h-[420px] transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1 overflow-hidden",children:e.jsxs("div",{className:"flex-1 w-full min-h-0 relative grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center h-full",children:[e.jsx("p",{className:"text-sm font-bold text-rose-400 mb-3 uppercase tracking-widest border-b border-rose-500/10 w-full text-center pb-3",children:"Expense Breakdown"}),e.jsx("div",{className:"flex-1 w-full relative min-h-[200px]",children:x.length>0?e.jsx(ve,{width:"100%",height:"100%",children:e.jsxs(Ce,{children:[e.jsx(Ie,{data:x,cx:"50%",cy:"50%",innerRadius:75,outerRadius:115,paddingAngle:5,dataKey:"value",stroke:"none",children:x.map((r,a)=>e.jsx(De,{fill:$e[a%$e.length]},`cell-${a}`))}),e.jsx(je,{formatter:r=>Z(r,i),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},itemStyle:{color:"#fff"}})]})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20",children:e.jsx(he,{className:"w-8 h-8"})})})]}),e.jsxs("div",{className:"flex flex-col items-center border-l border-slate-800 pl-4 h-full",children:[e.jsx("p",{className:"text-sm font-bold text-emerald-400 mb-3 uppercase tracking-widest border-b border-emerald-500/10 w-full text-center pb-3",children:"Income Breakdown"}),e.jsx("div",{className:"flex-1 w-full relative min-h-[200px]",children:l.length>0?e.jsx(ve,{width:"100%",height:"100%",children:e.jsxs(Ce,{children:[e.jsx(Ie,{data:l,cx:"50%",cy:"50%",innerRadius:75,outerRadius:115,paddingAngle:5,dataKey:"value",stroke:"none",children:l.map((r,a)=>e.jsx(De,{fill:_e[a%_e.length]},`cell-${a}`))}),e.jsx(je,{formatter:r=>Z(r,i),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},itemStyle:{color:"#fff"}})]})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20",children:e.jsx(he,{className:"w-8 h-8"})})})]})]})}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 flex flex-col shadow-sm h-[420px] transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Recent Activity"}),e.jsx("button",{onClick:w,className:"text-xs text-brand-400 hover:text-brand-300 font-medium transition-colors",children:"View All"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 [&::-webkit-scrollbar]:hidden",children:[m.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[e.jsx(ie,{className:"w-8 h-8 mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No recent activity."})]}),m.length>0&&e.jsx("div",{className:"space-y-3",children:m.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3.5 hover:bg-slate-950 rounded-2xl transition-all border border-transparent hover:border-slate-800 group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg ${r.type==="income"?"bg-emerald-500/10 text-emerald-500":"bg-rose-500/10 text-rose-500"}`,children:r.category.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-200 text-sm group-hover:text-white transition-colors",children:r.category}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(r.date).toLocaleDateString()})]})]}),e.jsxs("span",{className:`font-semibold text-sm ${r.type==="income"?"text-emerald-400":"text-slate-400"}`,children:[r.type==="income"?"+":"-",G(r.amount)," ",e.jsx("span",{className:"text-[10px] text-slate-500",children:r.currency})]})]},r.id))})]})]})]})]}),Rt=({transactions:t,baseCurrency:u,onDelete:c,onEdit:p,onAdd:i,getTransactionValue:x,customCategories:l})=>{const[g,m]=d.useState(""),[b,w]=d.useState("All"),[r,a]=d.useState("All"),[n,k]=d.useState("All"),F=d.useMemo(()=>{const s=t.map(E=>E.category);return Array.from(new Set(s)).sort()},[t]),y=d.useMemo(()=>t.filter(s=>{const E=s.description?.toLowerCase().includes(g.toLowerCase())||s.category.toLowerCase().includes(g.toLowerCase()),T=b==="All"||s.category===b,D=r==="All"||s.type===r;let j=!0;if(n!=="All"){const P=parseInt(n),S=new Date;S.setDate(S.getDate()-P),S.setHours(0,0,0,0),j=new Date(s.date)>=S}return E&&T&&D&&j}),[t,g,b,r,n]);return e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Transactions"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Manage your income and expenses."})]}),e.jsxs("button",{onClick:i,className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(ee,{className:"w-4 h-4"})," New"]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-4 flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(vt,{className:"absolute left-3 top-3 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:g,onChange:s=>m(s.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-9 pr-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0",children:[e.jsxs("select",{value:b,onChange:s=>w(s.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Categories"}),F.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:r,onChange:s=>a(s.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Types"}),e.jsx("option",{value:I.INCOME,children:"Income"}),e.jsx("option",{value:I.EXPENSE,children:"Expense"})]}),e.jsxs("select",{value:n,onChange:s=>k(s.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Time"}),e.jsx("option",{value:"30",children:"Last 30 Days"}),e.jsx("option",{value:"90",children:"Last 90 Days"}),e.jsx("option",{value:"365",children:"Last Year"})]})]})]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[e.jsx("thead",{className:"bg-slate-950/50 uppercase text-xs font-semibold tracking-wider text-slate-500 border-b border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Amount (Orig)"}),e.jsxs("th",{className:"px-6 py-4 text-right",children:["Value (",u,")"]}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[y.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-500",children:"No transactions found matching your filters."})}),y.map(s=>e.jsxs("tr",{className:"hover:bg-slate-950/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 text-slate-300 font-medium",children:s.editHistory&&s.editHistory.length>0?e.jsx(wt,{position:"top",content:`Last edited: ${new Date(s.editHistory[s.editHistory.length-1]).toLocaleString()}`,children:e.jsx("span",{className:"cursor-help border-b border-dotted border-slate-500 hover:border-brand-500 transition-colors",children:new Date(s.date).toLocaleDateString()})}):new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium border ${s.type==="income"?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"bg-rose-500/10 border-rose-500/20 text-rose-400"}`,children:s.category})}),e.jsx("td",{className:"px-6 py-4 text-slate-400 max-w-xs",children:e.jsx("div",{className:"truncate",title:s.description||"",children:s.description||"-"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-medium ${s.type==="income"?"text-emerald-400":"text-slate-400"}`,children:[G(s.amount)," ",e.jsx("span",{className:"text-xs text-slate-600",children:s.currency})]}),e.jsx("td",{className:`px-6 py-4 text-right font-medium ${s.type==="income"?"text-emerald-400":"text-slate-400"}`,children:G(x(s))}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{onClick:()=>p(s),className:"p-2 text-slate-500 hover:text-brand-400 hover:bg-brand-500/10 rounded-lg transition-all",title:"Edit Transaction",children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c(s.id),className:"p-2 text-slate-500 hover:text-rose-400 hover:bg-rose-500/10 rounded-lg transition-all",title:"Delete Transaction",children:e.jsx(ce,{className:"w-4 h-4"})})]})})]},s.id))]})]})})})]})},Tt=({data:t,onUpdate:u,baseCurrency:c,exchangeRates:p})=>{const[i,x]=d.useState(!1),[l,g]=d.useState({frequency:K.MONTHLY,currency:c,category:O.UTILITIES,active:!0,type:I.EXPENSE,exchangeRate:void 0}),m=()=>{const n=new Date;return n.setHours(0,0,0,0),(t.recurring||[]).filter(k=>{const F=new Date(k.nextDueDate);return F.setHours(0,0,0,0),k.active&&F<=n})},b=n=>{const k=n.exchangeRate||(n.currency===c?1:p[n.currency]),F={id:crypto.randomUUID(),amount:n.amount,currency:n.currency,category:n.category,type:n.type||I.EXPENSE,date:new Date().toISOString(),description:`Recurring: ${n.name}`,recordedBaseCurrency:c,exchangeRate:k},y=new Date(n.nextDueDate);n.frequency===K.MONTHLY?y.setMonth(y.getMonth()+1):n.frequency===K.WEEKLY?y.setDate(y.getDate()+7):n.frequency===K.YEARLY&&y.setFullYear(y.getFullYear()+1);const s=t.recurring.map(E=>E.id===n.id?{...E,nextDueDate:y.toISOString()}:E);u({...t,transactions:[F,...t.transactions],recurring:s})},w=()=>{if(!l.name||!l.amount)return;const n={id:crypto.randomUUID(),name:l.name,amount:Number(l.amount),currency:l.currency||c,frequency:l.frequency||K.MONTHLY,category:l.category||O.UTILITIES,nextDueDate:l.nextDueDate||new Date().toISOString(),active:!0,type:l.type||I.EXPENSE,exchangeRate:l.exchangeRate?Number(l.exchangeRate):void 0};u({...t,recurring:[...t.recurring||[],n]}),x(!1),g({frequency:K.MONTHLY,currency:c,category:O.UTILITIES,active:!0,type:I.EXPENSE,exchangeRate:void 0})},r=n=>{const k=Object.values(O).filter(y=>n===I.INCOME?te.includes(y):!te.includes(y)||y===O.OTHER),F=(t.customCategories||[]).filter(y=>y.type===n).map(y=>y.name);return[...k,...F]},a=m();return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Recurring Items"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Automate your regular income and expenses."})]}),e.jsxs("button",{onClick:()=>x(!0),className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(ee,{className:"w-4 h-4"})," New"]})]}),a.length>0&&e.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/30 rounded-3xl p-6",children:[e.jsxs("h3",{className:"text-brand-400 font-semibold mb-4 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"})," Due for Approval"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(n=>e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-4 rounded-xl flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-bold text-white",children:n.name}),e.jsx("span",{className:"text-xs bg-slate-800 text-slate-400 px-2 py-1 rounded",children:new Date(n.nextDueDate).toLocaleDateString()})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:"text-lg font-mono text-slate-200",children:[G(n.amount)," ",n.currency]}),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded uppercase ${n.type===I.INCOME?"text-emerald-400 bg-emerald-500/10":"text-rose-400 bg-rose-500/10"}`,children:n.type||"EXPENSE"})]}),n.exchangeRate&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Locked Rate: ",n.exchangeRate]})]}),e.jsx("button",{onClick:()=>b(n),className:"mt-4 w-full bg-brand-600 hover:bg-brand-500 text-white py-2 rounded-lg text-sm font-medium transition-colors",children:"Approve & Create"})]},n.id))})]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[e.jsx("thead",{className:"bg-slate-950/50 uppercase text-xs font-semibold tracking-wider text-slate-500 border-b border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Name"}),e.jsx("th",{className:"px-6 py-4",children:"Type"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Frequency"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Next Due"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[(t.recurring||[]).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-slate-500",children:"No recurring items defined."})}),(t.recurring||[]).map(n=>e.jsxs("tr",{className:"hover:bg-slate-950/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-white font-medium",children:n.name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded uppercase border ${n.type===I.INCOME?"text-emerald-400 border-emerald-500/20 bg-emerald-500/10":"text-rose-400 border-rose-500/20 bg-rose-500/10"}`,children:n.type||"EXPENSE"})}),e.jsx("td",{className:"px-6 py-4 text-slate-300",children:n.category}),e.jsx("td",{className:"px-6 py-4 text-slate-400",children:n.frequency}),e.jsxs("td",{className:"px-6 py-4 font-mono",children:[G(n.amount)," ",n.currency,n.exchangeRate&&e.jsxs("span",{className:"block text-[10px] text-slate-600",children:["@",n.exchangeRate]})]}),e.jsx("td",{className:"px-6 py-4",children:new Date(n.nextDueDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>u({...t,recurring:t.recurring.filter(k=>k.id!==n.id)}),className:"text-slate-500 hover:text-red-400",children:e.jsx(ce,{className:"w-4 h-4"})})})]},n.id))]})]})}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"New Recurring Item"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",placeholder:"Name (e.g. Salary, Netflix)",value:l.name||"",onChange:n=>g({...l,name:n.target.value})}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{type:"button",onClick:()=>g({...l,type:I.EXPENSE,category:O.UTILITIES}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${l.type===I.EXPENSE?"bg-rose-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Expense"}),e.jsx("button",{type:"button",onClick:()=>g({...l,type:I.INCOME,category:O.INCOME}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${l.type===I.INCOME?"bg-emerald-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Income"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block",children:"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto",children:r(l.type).map(n=>e.jsx("button",{type:"button",onClick:()=>g({...l,category:n}),className:`px-3 py-2 rounded-lg text-xs font-medium border transition-all text-left truncate ${l.category===n?"bg-slate-800 border-brand-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:n},n))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",type:"number",min:"0",placeholder:"Amount",value:l.amount||"",onChange:n=>g({...l,amount:Math.max(0,Number(n.target.value))})}),e.jsx("select",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:l.currency,onChange:n=>g({...l,currency:n.target.value}),children:Object.values(se).map(n=>e.jsx("option",{value:n,children:n},n))})]}),l.currency!==c&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Expected Exchange Rate (1 ",l.currency," = ?"," ",c,")"]}),e.jsx("input",{type:"number",step:"0.0001",min:"0",placeholder:`Current: ${p[l.currency||"USD"]||1}`,value:l.exchangeRate||"",onChange:n=>g({...l,exchangeRate:Math.max(0,Number(n.target.value))}),className:"w-full bg-transparent text-white focus:outline-none"}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:"Leave blank to use dynamic rate at time of approval."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:l.frequency,onChange:n=>g({...l,frequency:n.target.value}),children:Object.values(K).map(n=>e.jsx("option",{value:n,children:n},n))}),e.jsxs("div",{className:"flex-1 relative group/date",children:[e.jsx("input",{type:"date",className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-4 pr-10 py-3 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 transition-all cursor-pointer hover:border-slate-700 hover:bg-slate-900/50",value:l.nextDueDate?l.nextDueDate.split("T")[0]:"",onChange:n=>g({...l,nextDueDate:new Date(n.target.value).toISOString()})}),e.jsx(Ue,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-brand-400 group-hover/date:text-brand-300 transition-colors pointer-events-none z-10"})]})]}),e.jsx("button",{onClick:w,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:"Save Recurring Item"}),e.jsx("button",{onClick:()=>x(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})})]})},Lt=({data:t,onUpdate:u,baseCurrency:c,convertAmount:p,exchangeRates:i})=>{const[x,l]=d.useState(!1),[g,m]=d.useState(!1),[b,w]=d.useState(!1),[r,a]=d.useState(null),[n,k]=d.useState(""),[F,y]=d.useState(""),[s,E]=d.useState(""),[T,D]=d.useState(null),[j,P]=d.useState({currency:c,color:"#60a5fa",goalType:"money-out"}),S=h=>{a(h),k(""),y(""),E(""),D(null),m(!0)},M=h=>{a(h),w(!0)},U=()=>{if(!r||!n)return;const h=parseFloat(n);if(isNaN(h)||h<=0){D("Please enter a valid positive amount.");return}const C=r.targetAmount-r.currentAmount;if(h>C){D(`You cannot add more than the remaining amount (${G(C)} ${r.currency}).`);return}const L=r.currentAmount+h,A=L>=r.targetAmount,$=s?1/parseFloat(s):i[r.currency]||1,_={id:crypto.randomUUID(),date:new Date().toISOString(),amount:h,description:F.trim()||"Contribution"};let z=[...t.transactions];A&&(z=[{id:crypto.randomUUID(),amount:r.targetAmount,currency:r.currency,type:r.goalType==="money-out"?I.EXPENSE:I.INCOME,category:"Goal",date:new Date().toISOString(),description:r.name,recordedBaseCurrency:c,exchangeRate:$,goalId:r.id},...z]);const de=t.goals.map(Y=>Y.id===r.id?{...Y,currentAmount:L,status:A?"completed":"active",completedDate:A?new Date().toISOString():Y.completedDate,fundingHistory:[...Y.fundingHistory||[],_]}:Y);u({...t,transactions:z,goals:de}),m(!1)},H=()=>{if(!(!j.name||!j.targetAmount)){if(j.id){const C=t.goals.find(_=>_.id===j.id)?.name,L=j.name,A=t.goals.map(_=>_.id===j.id?{..._,name:L,targetAmount:Number(j.targetAmount),currency:j.currency||_.currency,color:j.color||_.color,goalType:j.goalType||_.goalType}:_);let $=t.transactions;C&&C!==L&&($=t.transactions.map(_=>{if(_.goalId===j.id){const z=`Goal: Contribution to ${C}`;if(_.description===z)return{..._,description:`Goal: Contribution to ${L}`};if(_.description?.includes(C))return{..._,description:_.description.replace(C,L)}}return _})),u({...t,goals:A,transactions:$})}else{const h={id:crypto.randomUUID(),name:j.name,targetAmount:Number(j.targetAmount),currentAmount:0,currency:j.currency||c,color:j.color||"#60a5fa",goalType:j.goalType||"money-out",status:"active",fundingHistory:[],createdDate:new Date().toISOString()};u({...t,goals:[...t.goals||[],h]})}l(!1),P({currency:c,color:"#60a5fa",goalType:"money-out"})}};return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Savings Goals"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Visualize your targets."})]}),e.jsxs("button",{onClick:()=>{P({currency:c,color:"#60a5fa",goalType:"money-out"}),l(!0)},className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(ee,{className:"w-4 h-4"})," New Goal"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(t.goals||[]).length===0?e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center p-12 text-center bg-slate-900 border border-slate-800 rounded-3xl border-dashed",children:[e.jsx("div",{className:"p-4 bg-slate-800 rounded-full mb-4",children:e.jsx(pe,{className:"w-8 h-8 text-slate-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"No Goals Yet"}),e.jsx("p",{className:"text-slate-400 text-sm max-w-xs mb-6",children:"Create a savings goal to track your progress for things like a vacation, new car, or emergency fund."}),e.jsx("button",{onClick:()=>l(!0),className:"bg-brand-600 hover:bg-brand-500 text-white px-6 py-2.5 rounded-xl text-sm font-bold transition-all hover:scale-105 active:scale-95 shadow-lg shadow-brand-500/20",children:"Create your first goal"})]}):(t.goals||[]).sort((h,C)=>{const L=h.status==="completed"||h.currentAmount>=h.targetAmount,A=C.status==="completed"||C.currentAmount>=C.targetAmount;return L===A?0:L?1:-1}).map(h=>{const C=Math.min(100,h.currentAmount/h.targetAmount*100),L=h.status==="completed"||h.currentAmount>=h.targetAmount;return e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm relative overflow-hidden transition-all duration-300 hover:border-slate-700 hover:shadow-2xl hover:-translate-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-white",children:h.name}),L&&e.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded uppercase bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",children:"Completed"})]}),e.jsxs("div",{className:"flex gap-2 relative z-30",children:[e.jsx("button",{onClick:A=>{A.stopPropagation(),P(h),l(!0)},className:"text-slate-600 hover:text-brand-400 transition-colors bg-slate-950/50 p-2 rounded-lg hover:bg-brand-500/10",title:"Edit Goal",children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),u({...t,goals:t.goals.filter($=>$.id!==h.id)})},className:"text-slate-600 hover:text-red-400 transition-colors bg-slate-950/50 p-2 rounded-lg hover:bg-red-500/10",title:"Delete Goal",children:e.jsx(ce,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"mb-4 relative z-10",children:e.jsxs("p",{className:"text-3xl font-bold text-white",children:[G(h.currentAmount)," ",e.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["/ ",G(h.targetAmount)," ",h.currency]})]})}),e.jsx("div",{className:"w-full bg-slate-800 h-3 rounded-full overflow-hidden relative z-10 mb-6",children:e.jsx("div",{className:"h-full transition-all duration-1000 ease-out relative overflow-hidden",style:{width:`${C}%`,backgroundColor:h.color},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-[shimmer_2s_infinite]"})})}),e.jsxs("div",{className:"flex gap-3 relative z-30",children:[e.jsx("button",{disabled:L,onClick:A=>{A.stopPropagation(),S(h)},className:`flex-1 py-3 rounded-xl font-medium transition-colors border ${L?"bg-slate-900 border-slate-800 text-slate-600 cursor-not-allowed":"bg-slate-800 hover:bg-slate-700 text-white border-slate-700"}`,children:L?"Goal Achieved":"+ Add Funds"}),e.jsxs("button",{onClick:A=>{A.stopPropagation(),M(h)},className:"px-4 py-3 rounded-xl font-medium transition-colors border bg-slate-800 hover:bg-slate-700 text-white border-slate-700 flex items-center gap-2",title:"View History",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"History"})]})]}),e.jsx("div",{className:"absolute -bottom-10 -right-10 w-32 h-32 rounded-full opacity-25 blur-2xl pointer-events-none",style:{backgroundColor:h.color}})]},h.id)})}),x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:j.id?"Edit Goal":"New Goal"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",placeholder:"Goal Name (e.g. Japan Trip)",value:j.name||"",onChange:h=>P({...j,name:h.target.value})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block",children:"Goal Type"}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{type:"button",onClick:()=>P({...j,goalType:"money-out"}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${(j.goalType||"money-out")==="money-out"?"bg-rose-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:" Money Out"}),e.jsx("button",{type:"button",onClick:()=>P({...j,goalType:"money-in"}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${j.goalType==="money-in"?"bg-emerald-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:" Money In"})]}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1.5 px-1",children:(j.goalType||"money-out")==="money-out"?"Goal will create an expense when achieved (e.g., buying a car, vacation)":"Goal will create an income when achieved (e.g., savings target, investment goal)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",type:"number",min:"0",placeholder:"Target Amount",value:j.targetAmount||"",onChange:h=>P({...j,targetAmount:Math.max(0,Number(h.target.value))})}),e.jsx("select",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:j.currency,onChange:h=>P({...j,currency:h.target.value}),children:Object.values(se).map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Color:"}),e.jsx("input",{type:"color",className:"bg-transparent h-10 w-10 cursor-pointer",value:j.color,onChange:h=>P({...j,color:h.target.value})})]}),e.jsx("button",{onClick:H,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:j.id?"Update Goal":"Create Goal"}),e.jsx("button",{onClick:()=>l(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})}),g&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-sm shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Add Funds"}),e.jsxs("p",{className:"text-slate-400 text-sm mb-4",children:["Adding to ",e.jsx("strong",{children:r.name})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white pl-12",type:"number",min:"0",placeholder:"0.00",value:n,onChange:h=>{const C=h.target.value;(C===""||parseFloat(C)>=0)&&k(C)},autoFocus:!0}),e.jsx("span",{className:"absolute left-3 top-3 text-slate-500 font-medium",children:r.currency})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm",type:"text",placeholder:"Note (Optional)",value:F,onChange:h=>y(h.target.value)})}),r.currency!==c&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Exchange Rate (1 ",r.currency," = ? ",c,")"]}),e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx("input",{type:"number",step:"any",min:"0",value:s,onChange:h=>{const C=h.target.value;(C===""||parseFloat(C)>=0)&&E(C)},placeholder:`${oe(1/(i[r.currency]||1))}`,className:"flex-1 bg-transparent text-white focus:outline-none font-mono text-sm"})}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:s?`Using custom rate: 1 ${r.currency} = ${s} ${c}`:`Using market rate: 1 ${r.currency} = ${oe(1/(i[r.currency]||1))} ${c}`})]}),T&&e.jsx("p",{className:"text-red-400 text-xs bg-red-900/20 p-2 rounded-lg border border-red-900/30",children:T}),e.jsx("button",{onClick:U,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:"Confirm Deposit"}),e.jsx("button",{onClick:()=>m(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})}),b&&r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:r.name}),e.jsx("p",{className:"text-slate-400 text-sm",children:r.status==="completed"?"Completed Goal":"Active Goal"}),r.createdDate&&e.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:["Created:"," ",new Date(r.createdDate).toLocaleDateString()," "," ",new Date(r.createdDate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("button",{onClick:()=>w(!1),className:"text-slate-500 hover:text-white transition-colors p-1",children:e.jsx(ee,{className:"w-6 h-6 rotate-45"})})]}),e.jsxs("div",{className:"space-y-4 overflow-y-auto pr-2 custom-scrollbar flex-1",children:[e.jsxs("div",{className:"bg-slate-950 p-4 rounded-2xl border border-slate-800",children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsx("span",{className:"text-xs text-slate-500 uppercase tracking-wider font-semibold",children:"Progress"}),e.jsxs("span",{className:"text-sm font-mono text-brand-400 font-bold",children:[r.targetAmount>0?Math.round(r.currentAmount/r.targetAmount*100):0,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-all duration-500",style:{width:`${Math.min(100,r.targetAmount>0?r.currentAmount/r.targetAmount*100:0)}%`,backgroundColor:r.color}})}),e.jsxs("div",{className:"mt-3 flex justify-between items-baseline",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:G(r.currentAmount)}),e.jsxs("span",{className:"text-slate-500 text-sm",children:["of ",G(r.targetAmount)," ",r.currency]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-2 px-1",children:"Funding History"}),e.jsx("div",{className:"space-y-2",children:!r.fundingHistory||r.fundingHistory.length===0?e.jsx("div",{className:"text-center py-8 bg-slate-950/50 rounded-2xl border border-slate-800 border-dashed text-slate-600 text-sm",children:"No contributions yet."}):[...r.fundingHistory].reverse().map(h=>e.jsxs("div",{className:"bg-slate-950 border border-slate-800 p-3 rounded-xl flex justify-between items-center group",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium text-sm",children:h.description}),e.jsxs("p",{className:"text-[10px] text-slate-500",children:[new Date(h.date).toLocaleDateString()," "," ",new Date(h.date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-emerald-400 font-mono font-bold",children:["+",G(h.amount)]})})]},h.id))})]}),(r.status==="completed"||r.currentAmount>=r.targetAmount)&&e.jsx("div",{className:"bg-emerald-500/10 border border-emerald-500/20 p-4 rounded-2xl",children:e.jsxs("p",{className:"text-emerald-400 text-sm font-medium flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"})," Goal achieved!"]})})]}),e.jsx("button",{onClick:()=>w(!1),className:"w-full bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-xl font-bold mt-6 transition-colors",children:"Close"})]})})]})},Mt=({data:t,onUpdateData:u,onVaultDeleted:c,exchangeRates:p})=>{const[i,x]=d.useState(""),[l,g]=d.useState(I.EXPENSE),[m,b]=d.useState(null),[w,r]=d.useState(!1),[a,n]=d.useState("csv"),k=()=>{if(!i.trim())return;const s=Object.values(O),E=(t.customCategories||[]).map(D=>D.name);if(s.includes(i)||E.includes(i)){alert("Category already exists");return}const T={name:i.trim(),type:l};u({...t,customCategories:[...t.customCategories||[],T]}),x("")},F=s=>{u({...t,customCategories:(t.customCategories||[]).filter(E=>E.name!==s)})},y=()=>{if(b(null),!(t.transactions.length>0||(t.goals||[]).length>0||(t.recurring||[]).length>0)){b({type:"error",text:"Export Failed: Vault is empty. Add some data first."});return}const E=localStorage.getItem(J),T=localStorage.getItem(q);if(!E||!T){b({type:"error",text:"Export Failed: No secure data found to export."});return}const D={salt:E,data:T,version:"1.0",timestamp:new Date().toISOString()},j=JSON.stringify(D),P=new Blob([j],{type:"application/json"}),S=URL.createObjectURL(P),M=document.createElement("a");M.href=S;const U=t.vaultName?t.vaultName.replace(/[^a-z0-9]/gi,"_").toLowerCase():"vault",H=new Date,h=H.toISOString().split("T")[0],C=H.toTimeString().split(" ")[0].replace(/:/g,"");M.download=`${U}_backup_${h}_${C}.vf`,document.body.appendChild(M),M.click(),document.body.removeChild(M),b({type:"success",text:"Backup downloaded successfully."}),setTimeout(()=>b(null),3e3)};return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Settings"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure your vault."})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Vault Name"}),e.jsx("input",{type:"text",name:"username",maxLength:21,value:t.vaultName||"",onChange:s=>{const E=s.target.value;u({...t,vaultName:E}),E.trim()&&localStorage.setItem(le,E)},className:`w-full bg-slate-950 border rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 ${t.vaultName?.trim()?"border-slate-800 focus:border-transparent":"border-red-500/50 focus:border-red-500"}`,placeholder:"Name your vault"}),!t.vaultName?.trim()&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:"Vault name is required."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Base Currency"}),e.jsx("select",{value:t.baseCurrency,onChange:s=>u({...t,baseCurrency:s.target.value}),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",children:Object.values(se).map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"All transactions will be converted to this currency for aggregation."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Auto Lock Timer"}),e.jsxs("select",{value:t.autoLockDuration,onChange:s=>u({...t,autoLockDuration:Number(s.target.value)}),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",children:[e.jsx("option",{value:6e4,children:"1 Minute"}),e.jsx("option",{value:3e5,children:"5 Minutes"}),e.jsx("option",{value:9e5,children:"15 Minutes"}),e.jsx("option",{value:18e5,children:"30 Minutes"}),e.jsx("option",{value:0,children:"Never"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Automatically lock vault after inactivity."})]})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Custom Categories (Tags)"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{onClick:()=>g(I.EXPENSE),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${l===I.EXPENSE?"bg-rose-500/20 text-rose-400":"text-slate-500"}`,children:"Expense"}),e.jsx("button",{onClick:()=>g(I.INCOME),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${l===I.INCOME?"bg-emerald-500/20 text-emerald-400":"text-slate-500"}`,children:"Income"})]}),e.jsx("input",{value:i,onChange:s=>x(s.target.value),placeholder:"New Tag Name",className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl px-3 text-white text-sm"}),e.jsx("button",{onClick:k,className:"bg-brand-600 hover:bg-brand-500 text-white px-4 rounded-xl text-sm font-bold",children:"Add"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(t.customCategories||[]).filter(s=>s.type===l).map(s=>e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-slate-700 bg-slate-800 text-sm text-slate-300",children:[s.name,e.jsx("button",{onClick:()=>F(s.name),className:"text-slate-500 hover:text-red-400",children:e.jsx(ce,{className:"w-3 h-3"})})]},s.name)),Object.values(O).filter(s=>l===I.INCOME?te.includes(s):!te.includes(s)||s===O.OTHER).map(s=>e.jsx("span",{className:"px-3 py-1.5 rounded-lg border border-slate-800 bg-slate-950 text-sm text-slate-500 cursor-not-allowed",title:"Default Category",children:s},s))]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Data Management"}),m&&e.jsx("div",{className:`mb-4 px-4 py-3 rounded-xl border text-sm ${m.type==="error"?"bg-red-900/20 border-red-900/50 text-red-400":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400"}`,children:m.text}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-slate-950 rounded-xl border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:"Export Transactions"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Download history as CSV or Excel."})]}),e.jsxs("div",{className:"flex bg-slate-900 border border-slate-800 rounded-lg p-1 w-fit mb-2",children:[e.jsx("button",{onClick:()=>n("csv"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${a==="csv"?"bg-slate-700 text-white shadow-sm":"text-slate-500 hover:text-slate-300"}`,children:"CSV"}),e.jsx("button",{onClick:()=>n("excel"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${a==="excel"?"bg-emerald-600/20 text-emerald-400 shadow-sm":"text-slate-500 hover:text-slate-300"}`,children:"Excel"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[{label:"Last 15 Days",val:15},{label:"Last 1 Month",val:30},{label:"Last 3 Months",val:90},{label:"Last 6 Months",val:180},{label:"Last 1 Year",val:365},{label:"All Time",val:"all"}].map(s=>e.jsx("button",{onClick:()=>{b(null);const E=t.transactions||[];if(E.length===0){b({type:"error",text:"Export Failed: No transactions to export."});return}let T=E;if(s.val!=="all"){const L=Number(s.val),A=new Date;A.setDate(A.getDate()-L),A.setHours(0,0,0,0),T=E.filter($=>new Date($.date)>=A)}if(T.length===0){b({type:"error",text:"Export Failed: No transactions found in this range."});return}const D="\uFEFF",j=a==="excel"?"	":",",P=a==="excel"?"xls":"csv",S=["Date","Type","Category","Description","Amount","Currency"],M=T.map(L=>{const A=$=>`"${($||"").replace(/"/g,'""')}"`;return[new Date(L.date).toLocaleDateString(),L.type,A(L.category),A(L.description||""),L.amount,L.currency].join(j)}),U=D+[S.join(j),...M].join(`
`),H=new Blob([U],{type:a==="excel"?"application/vnd.ms-excel;charset=utf-8":"text/csv;charset=utf-8"}),h=URL.createObjectURL(H),C=document.createElement("a");C.href=h,C.download=`transactions_${s.val==="all"?"all_time":s.val+"_days"}_${new Date().toISOString().split("T")[0]}.${P}`,document.body.appendChild(C),C.click(),document.body.removeChild(C),b({type:"success",text:`Successfully exported ${T.length} transactions (${a.toUpperCase()}).`}),setTimeout(()=>b(null),3e3)},className:"px-3 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-medium transition-colors border border-slate-700 hover:border-slate-600 hover:text-brand-300",children:s.label},s.label))})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:"Export Data"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Download an encrypted backup file (.vf)."})]}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Download"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-900/10 rounded-xl border border-red-900/30",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-red-400 font-medium",children:"Delete Vault"}),e.jsx("p",{className:"text-sm text-red-400/60",children:"Permanently delete all data and reset."})]}),e.jsx("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-medium transition-colors",children:"Delete"})]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-6 w-full max-w-sm shadow-2xl animate-in zoom-in-95 duration-200",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Delete Vault?"}),e.jsx("p",{className:"text-slate-400 text-sm mb-6",children:"This will permanently erase all your financial data and reset the application. This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>r(!1),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white py-2.5 rounded-xl font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{c(),r(!1)},className:"flex-1 bg-red-600 hover:bg-red-500 text-white py-2.5 rounded-xl font-medium transition-colors",children:"Delete Forever"})]})]})})]})},Ot=({initialData:t,onClose:u,onSave:c,baseCurrency:p,exchangeRates:i,customCategories:x})=>{const[l,g]=d.useState(t?.amount?.toString()||""),[m,b]=d.useState(t?.currency||p),[w,r]=d.useState(t?.type||I.EXPENSE),[a,n]=d.useState(t?.category||O.FOOD),[k,F]=d.useState(t?.date?t.date.split("T")[0]:new Date().toISOString().split("T")[0]),[y,s]=d.useState(t?.description||""),[E,T]=d.useState(t?.exchangeRate?.toString()||""),D=!!t?.goalId,j=d.useMemo(()=>{const S=Object.values(O).filter(U=>w===I.INCOME?te.includes(U):!te.includes(U)||U===O.OTHER),M=(x||[]).filter(U=>U.type===w).map(U=>U.name);return[...S,...M]},[w,x]);d.useEffect(()=>{D||j.includes(a)||n(j[0]||"")},[w,j,D]),d.useEffect(()=>{t?.currency!==m&&T("")},[m,t]);const P=S=>{if(S.preventDefault(),!l)return;const M=E?1/parseFloat(E):i[m]||1,U={...t||{},id:t?.id||crypto.randomUUID(),amount:parseFloat(l),currency:m,type:w,category:a,date:new Date(k).toISOString(),description:y,recordedBaseCurrency:t?.recordedBaseCurrency||p,exchangeRate:M,editHistory:t?[...t.editHistory||[],new Date().toISOString()]:t?.editHistory};c(U)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl scale-100 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:t?"Edit Transaction":"New Transaction"}),e.jsx("button",{onClick:u,className:"text-slate-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",min:"0",value:l,onChange:S=>{const M=S.target.value;(M===""||parseFloat(M)>=0)&&g(M)},placeholder:"0.00",className:"w-full bg-slate-950 border border-slate-800 rounded-2xl px-4 py-3 text-2xl font-bold text-white placeholder:text-slate-700 focus:outline-none focus:ring-2 focus:ring-brand-500/50",autoFocus:!0}),e.jsx("div",{className:"absolute right-2 top-2 bottom-2",children:e.jsx("select",{value:m,disabled:D,onChange:S=>b(S.target.value),className:`h-full bg-slate-900 border border-slate-800 rounded-xl px-3 text-white text-sm font-medium focus:outline-none focus:ring-1 focus:ring-brand-500 ${D?"opacity-50 cursor-not-allowed":""}`,children:Object.values(se).map(S=>e.jsx("option",{value:S,children:S},S))})})]})}),m!==p&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Exchange Rate (1 ",m," = ? ",p,")"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"number",step:"any",min:"0",value:E,onChange:S=>{const M=S.target.value;(M===""||parseFloat(M)>=0)&&T(M)},placeholder:`${oe(1/(i[m]||1))}`,className:"flex-1 bg-transparent text-white focus:outline-none font-mono text-sm"}),e.jsx("button",{type:"button",onClick:()=>T(oe(1/(i[m]||1))),className:"text-[10px] text-brand-400 hover:text-brand-300 uppercase font-bold tracking-wider",children:"Auto"})]}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:E?`Using custom rate: 1 ${m} = ${E} ${p}`:`Using market rate: 1 ${m} = ${oe(1/(i[m]||1))} ${p}`})]}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800 relative",children:[D&&e.jsx("div",{className:"absolute inset-0 z-10 cursor-not-allowed"}),e.jsx("button",{type:"button",disabled:D,onClick:()=>{r(I.EXPENSE)},className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${w===I.EXPENSE?"bg-rose-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"} ${D?"opacity-50":""}`,children:"Expense"}),e.jsx("button",{type:"button",disabled:D,onClick:()=>{r(I.INCOME)},className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${w===I.INCOME?"bg-emerald-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"} ${D?"opacity-50":""}`,children:"Income"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Category"}),D&&e.jsx("span",{className:"text-[10px] text-brand-400 font-bold uppercase tracking-tight",children:"Locked for Goal"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 max-h-36 overflow-y-auto pr-1 categories-container relative",children:[D&&e.jsx("div",{className:"absolute inset-0 z-10 cursor-not-allowed"}),j.map(S=>e.jsx("button",{type:"button",disabled:D,onClick:()=>n(S),className:`px-3 py-1.5 rounded-lg text-xs font-medium border transition-all ${a===S?"bg-brand-600 border-brand-500 text-white shadow-lg shadow-brand-600/20":"bg-slate-950/50 border-slate-800 text-slate-400 hover:border-slate-700 hover:text-slate-200"} ${D&&a!==S?"opacity-30":""}`,children:S},S))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block text-center",children:"Date"}),e.jsxs("div",{className:"relative group/date",children:[e.jsx("input",{type:"date",value:k,onChange:S=>F(S.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-4 pr-10 py-2.5 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 transition-all cursor-pointer hover:border-slate-700 hover:bg-slate-900/50"}),e.jsx(Ue,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-brand-400 group-hover/date:text-brand-300 transition-colors pointer-events-none z-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block text-center",children:"Note"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",disabled:D,value:y,onChange:S=>s(S.target.value),placeholder:D?"Goal reference":"What is this for?",className:`w-full bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 hover:border-slate-700 transition-all ${D?"opacity-50 cursor-not-allowed":""}`})})]})]}),e.jsx("button",{type:"submit",disabled:!l,className:"w-full bg-white hover:bg-slate-200 text-black font-bold py-3.5 rounded-xl transition-all shadow-lg mt-6 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Save Changes":"Create Transaction"})]})]})})},Ve=document.getElementById("root");if(!Ve)throw new Error("Could not find root element to mount to");const Ft=ut.createRoot(Ve);Ft.render(e.jsx(Pe.StrictMode,{children:e.jsx(Ct,{})}));
