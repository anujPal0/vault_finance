import{r as _e,a as $e,g as Pe}from"./vendor-react.js";import{r as b,R as Ae,a as me,B as Ve,C as Ue,X as Be,Y as ze,T as he,b as je,P as we,c as ye,d as Ne}from"./vendor-recharts.js";import"./vendor-utils.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))p(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const a of d.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&p(a)}).observe(document,{childList:!0,subtree:!0});function r(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function p(c){if(c.ep)return;c.ep=!0;const d=r(c);fetch(c.href,d)}})();var pe={exports:{}},X={};var Se;function Ge(){if(Se)return X;Se=1;var t=_e(),m=Symbol.for("react.element"),r=Symbol.for("react.fragment"),p=Object.prototype.hasOwnProperty,c=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function a(x,j,l){var h,u={},i=null,s=null;l!==void 0&&(i=""+l),j.key!==void 0&&(i=""+j.key),j.ref!==void 0&&(s=j.ref);for(h in j)p.call(j,h)&&!d.hasOwnProperty(h)&&(u[h]=j[h]);if(x&&x.defaultProps)for(h in j=x.defaultProps,j)u[h]===void 0&&(u[h]=j[h]);return{$$typeof:m,type:x,key:i,ref:s,props:u,_owner:c.current}}return X.Fragment=r,X.jsx=a,X.jsxs=a,X}var ke;function Ye(){return ke||(ke=1,pe.exports=Ge()),pe.exports}var e=Ye(),ae={},Ee;function He(){if(Ee)return ae;Ee=1;var t=$e();return ae.createRoot=t.createRoot,ae.hydrateRoot=t.hydrateRoot,ae}var Ke=He();const We=Pe(Ke);var q=(t=>(t.USD="USD",t.EUR="EUR",t.GBP="GBP",t.JPY="JPY",t.CAD="CAD",t.AUD="AUD",t.INR="INR",t.CNY="CNY",t))(q||{}),E=(t=>(t.INCOME="income",t.EXPENSE="expense",t))(E||{}),A=(t=>(t.FOOD="Food",t.TRANSPORT="Transport",t.HOUSING="Housing",t.UTILITIES="Utilities",t.ENTERTAINMENT="Entertainment",t.HEALTH="Health",t.INCOME="Salary",t.SHOPPING="Shopping",t.SAVINGS="Savings",t.RENTAL="Rental",t.FREELANCE="Freelance",t.BONUS="Bonus",t.INVESTMENTS="Investments",t.REFUNDS="Refunds",t.GIFT="Gift",t.OTHER="Other",t))(A||{}),G=(t=>(t.WEEKLY="Weekly",t.MONTHLY="Monthly",t.YEARLY="Yearly",t))(G||{});const qe=1e5,Xe=16,be=12;class Je{constructor(){this.key=null}async deriveKey(m,r){const p=new TextEncoder,c=await window.crypto.subtle.importKey("raw",p.encode(m),{name:"PBKDF2"},!1,["deriveKey"]),d=r||window.crypto.getRandomValues(new Uint8Array(Xe)),a=await window.crypto.subtle.deriveKey({name:"PBKDF2",salt:d,iterations:qe,hash:"SHA-256"},c,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]);return this.key=a,{key:a,salt:d}}hasKey(){return this.key!==null}clearKey(){this.key=null}async encrypt(m){if(!this.key)throw new Error("Key not initialized");const r=new TextEncoder,p=window.crypto.getRandomValues(new Uint8Array(be)),c=r.encode(m),d=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:p},this.key,c),a=new Uint8Array(p.byteLength+d.byteLength);return a.set(p,0),a.set(new Uint8Array(d),p.byteLength),this.arrayBufferToBase64(a)}async decrypt(m){if(!this.key)throw new Error("Key not initialized");const r=this.base64ToArrayBuffer(m),p=r.slice(0,be),c=r.slice(be),d=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:p},this.key,c);return new TextDecoder().decode(d)}arrayBufferToBase64(m){let r="";const p=m.byteLength;for(let c=0;c<p;c++)r+=String.fromCharCode(m[c]);return window.btoa(r)}base64ToArrayBuffer(m){const r=window.atob(m),p=r.length,c=new Uint8Array(p);for(let d=0;d<p;d++)c[d]=r.charCodeAt(d);return c}}const Y=new Je,Ce="vf_rates_cache",Qe=1e3*60*60*24,Ze=async t=>{const m=localStorage.getItem(Ce);if(m)try{const r=JSON.parse(m),p=Date.now()-r.timestamp<Qe,c=r.base===t;if(p&&c)return r.rates}catch{}try{const r=await fetch(`https://open.er-api.com/v6/latest/${t}`);if(!r.ok)throw new Error("Failed to fetch rates");const c=(await r.json()).rates,d={timestamp:Date.now(),base:t,rates:c};return localStorage.setItem(Ce,JSON.stringify(d)),c}catch{return m?JSON.parse(m).rates:{[t]:1}}},ne=({className:t})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:e.jsx("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),te=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M12 5v14"})]}),se=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),oe=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83"}),e.jsx("path",{d:"M22 12A10 10 0 0 0 12 2v10z"})]}),ie=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("line",{x1:"8",x2:"21",y1:"6",y2:"6"}),e.jsx("line",{x1:"8",x2:"21",y1:"12",y2:"12"}),e.jsx("line",{x1:"8",x2:"21",y1:"18",y2:"18"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}),e.jsx("line",{x1:"3",x2:"3.01",y1:"18",y2:"18"})]}),et=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),De=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),fe=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{d:"m17 2 4 4-4 4"}),e.jsx("path",{d:"M3 11v-1a4 4 0 0 1 4-4h14"}),e.jsx("path",{d:"m7 22-4-4 4-4"}),e.jsx("path",{d:"M21 13v1a4 4 0 0 1-4 4H3"})]}),ge=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("circle",{cx:"12",cy:"12",r:"6"}),e.jsx("circle",{cx:"12",cy:"12",r:"2"})]}),tt=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),Re=({className:t})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),H="vf_encrypted_vault",K="vf_salt",ee="vf_vault_name",ve=300*1e3,re=["#f87171","#fbbf24","#f472b6","#a78bfa","#f97316","#e11d48","#c084fc"],le=["#34d399","#60a5fa","#2dd4bf","#818cf8","#4ade80","#22d3ee","#6366f1"],W=[A.INCOME,A.SAVINGS,A.RENTAL,A.FREELANCE,A.BONUS,A.INVESTMENTS,A.REFUNDS,A.GIFT,A.OTHER],J={transactions:[],recurring:[],goals:[],baseCurrency:q.USD,theme:"dark",autoLockDuration:ve,customCategories:[]},Q=(t,m)=>{const r=Math.abs(t)>=1e3;return new Intl.NumberFormat(void 0,{style:"currency",currency:m,notation:r?"compact":"standard",maximumFractionDigits:r?3:2,minimumFractionDigits:r?0:2}).format(t)},B=t=>{const m=Math.abs(t)>=1e3;return new Intl.NumberFormat(void 0,{notation:m?"compact":"standard",maximumFractionDigits:m?3:2,minimumFractionDigits:m?0:2}).format(t)};function st(){const[t,m]=b.useState(!!localStorage.getItem(K)),[r,p]=b.useState(!1),[c,d]=b.useState(""),[a,x]=b.useState(!1),[j,l]=b.useState(null),[h,u]=b.useState(localStorage.getItem(ee)||""),[i,s]=b.useState(J),[k,D]=b.useState({}),[o,n]=b.useState("dashboard"),[S,y]=b.useState(!1),[L,N]=b.useState(!1),T=b.useRef(Date.now());b.useEffect(()=>{if(!r)return;const f=i.autoLockDuration!==void 0?i.autoLockDuration:ve;if(f===0)return;const w=()=>{Date.now()-T.current>f&&P()},v=()=>{T.current=Date.now()},I=setInterval(w,1e4);return window.addEventListener("mousemove",v),window.addEventListener("keydown",v),window.addEventListener("click",v),()=>{clearInterval(I),window.removeEventListener("mousemove",v),window.removeEventListener("keydown",v),window.removeEventListener("click",v)}},[r,i.autoLockDuration]);const O=async(f,w,v)=>{if(f.preventDefault(),l(null),v.length<4){l("Password is too short (min 4 chars).");return}if(w.length>21){l("Vault Name must be 21 characters or less.");return}x(!0);try{const{salt:I}=await Y.deriveKey(v),F=btoa(String.fromCharCode(...I));localStorage.setItem(K,F),w&&(localStorage.setItem(ee,w),u(w));const C={...J,vaultName:w},z=JSON.stringify(C),xe=await Y.encrypt(z);localStorage.setItem(H,xe),s(C),m(!0),p(!0),d("")}catch{l("Failed to create vault.")}finally{x(!1)}},g=f=>{new Date().setHours(0,0,0,0),(f.recurring||[]).forEach(I=>{if(!I.active)return;new Date(I.nextDueDate).setHours(0,0,0,0)})},V=async f=>{f.preventDefault(),x(!0),l(null);try{const w=localStorage.getItem(K),v=localStorage.getItem(H);if(!w){m(!1);return}const I=new Uint8Array(atob(w).split("").map(F=>F.charCodeAt(0)));if(await Y.deriveKey(c,I),v)try{const F=await Y.decrypt(v),C=JSON.parse(F);let z=!1;const xe=C.transactions.map(ue=>ue.recordedBaseCurrency?ue:(z=!0,{...ue,recordedBaseCurrency:C.baseCurrency}));C.recurring||(C.recurring=[],z=!0),C.goals||(C.goals=[],z=!0),C.autoLockDuration===void 0&&(C.autoLockDuration=ve,z=!0),C.customCategories||(C.customCategories=[],z=!0),z&&(C.transactions=xe,M(C)),C.vaultName&&C.vaultName!==h&&(localStorage.setItem(ee,C.vaultName),u(C.vaultName)),s(C),p(!0),g(C)}catch{l("Incorrect password.")}else s(J),p(!0)}catch{l("An error occurred during authentication.")}finally{x(!1),d("")}},P=()=>{Y.clearKey(),p(!1),d(""),s(J),n("dashboard")},U=()=>{localStorage.clear(),Y.clearKey(),s(J),p(!1),m(!1),d(""),u(""),n("dashboard")},M=async f=>{try{const w=JSON.stringify(f),v=await Y.encrypt(w);localStorage.setItem(H,v)}catch{alert("Failed to save data securely!")}},R=f=>{s(f),M(f)};b.useEffect(()=>{r&&(async()=>{const w=await Ze(i.baseCurrency);D(w)})()},[r,i.baseCurrency]);const $=b.useCallback((f,w,v)=>{if(w===v||!k[w]&&!k[v])return f;if(v===i.baseCurrency){const C=k[w];return C?f/C:f}if(w===i.baseCurrency){const C=k[v];return C?f*C:f}const I=k[w],F=k[v];return!I||!F?f:f/I*F},[k,i.baseCurrency]),_=b.useCallback(f=>{if(f.exchangeRate&&f.recordedBaseCurrency){const w=f.amount/f.exchangeRate;return $(w,f.recordedBaseCurrency,i.baseCurrency)}return $(f.amount,f.currency,i.baseCurrency)},[i.baseCurrency,$]),Te=b.useMemo(()=>i.transactions.reduce((f,w)=>{const v=_(w);return f+(w.type===E.INCOME?v:-v)},0),[i.transactions,_]),ce=b.useMemo(()=>{const f=i.transactions.filter(v=>v.type===E.EXPENSE),w={};return f.forEach(v=>{const I=_(v);w[v.category]=(w[v.category]||0)+I}),Object.entries(w).map(([v,I])=>({name:v,value:I}))},[i.transactions,_]),de=b.useMemo(()=>{const f=i.transactions.filter(v=>v.type===E.INCOME),w={};return f.forEach(v=>{const I=_(v);w[v.category]=(w[v.category]||0)+I}),Object.entries(w).map(([v,I])=>({name:v,value:I}))},[i.transactions,_]),Oe=b.useMemo(()=>de.reduce((f,w)=>f+w.value,0),[de]),Me=b.useMemo(()=>ce.reduce((f,w)=>f+w.value,0),[ce]),Fe=b.useMemo(()=>{const f={},w=new Date;for(let v=5;v>=0;v--){const F=new Date(w.getFullYear(),w.getMonth()-v,1).toLocaleString("default",{month:"short"});f[F]={income:0,expense:0}}return i.transactions.forEach(v=>{const I=new Date(v.date);if(w.getTime()-I.getTime()<4320*60*60*1e3){const F=I.toLocaleString("default",{month:"short"});if(f[F]){const C=_(v);v.type===E.INCOME?f[F].income+=C:f[F].expense+=C}}}),Object.entries(f).map(([v,I])=>({name:v,Income:I.income,Expense:I.expense}))},[i.transactions,_]);return t?r?e.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col md:flex-row text-slate-200 font-sans",children:[e.jsxs("aside",{className:"hidden md:flex flex-col w-64 border-r border-slate-800 bg-slate-950 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10 px-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-xl shadow-lg shadow-brand-500/20",children:e.jsx(ne,{className:"w-6 h-6 text-white"})}),e.jsxs("span",{className:"font-bold text-lg tracking-tight text-white flex flex-col leading-tight min-w-0",children:[e.jsx("span",{children:"Vault Finance"}),e.jsx("span",{className:"text-xs text-brand-400 font-mono font-medium tracking-wider cursor-default",children:"v1.0.0"})]})]}),e.jsxs("nav",{className:"flex-1 space-y-2",children:[e.jsx(Z,{active:o==="dashboard",onClick:()=>n("dashboard"),icon:e.jsx(oe,{}),label:"Dashboard"}),e.jsx(Z,{active:o==="transactions",onClick:()=>n("transactions"),icon:e.jsx(ie,{}),label:"Transactions"}),e.jsx(Z,{active:o==="recurring",onClick:()=>n("recurring"),icon:e.jsx(fe,{}),label:"Recurring"}),e.jsx(Z,{active:o==="goals",onClick:()=>n("goals"),icon:e.jsx(ge,{}),label:"Goals"}),e.jsx(Z,{active:o==="settings",onClick:()=>n("settings"),icon:e.jsx(et,{}),label:"Settings"})]}),e.jsxs("button",{onClick:P,className:"flex items-center gap-3 text-slate-500 hover:text-white transition-colors mt-auto pt-6 border-t border-slate-800 text-sm font-medium px-2",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:"Lock Vault"})]})]}),e.jsxs("div",{className:"md:hidden flex items-center justify-between p-4 border-b border-slate-800 bg-slate-950/80 backdrop-blur-md sticky top-0 z-20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5 text-white"})}),e.jsxs("span",{className:"font-bold text-lg text-white flex flex-col leading-tight min-w-0",children:[e.jsx("span",{children:"Vault Finance"}),e.jsx("span",{className:"text-xs text-brand-400 font-mono font-medium tracking-wider cursor-default",children:"v1.0.0"})]})]}),e.jsx("button",{onClick:P,className:"text-slate-500 hover:text-white",children:e.jsx(De,{className:"w-5 h-5"})})]}),e.jsx("main",{className:"flex-1 overflow-y-auto h-screen relative scrollbar-hide bg-slate-950",children:e.jsxs("div",{className:"p-6 max-w-6xl mx-auto pb-24 md:pb-6 relative z-10",children:[o==="dashboard"&&e.jsx(lt,{balance:Te,totalIncome:Oe,totalExpense:Me,baseCurrency:i.baseCurrency,expensesByCategory:ce,incomeByCategory:de,monthlyData:Fe,recentTransactions:i.transactions.slice(0,5),onAddTransaction:()=>y(!0),onViewAll:()=>n("transactions")}),o==="transactions"&&e.jsx(nt,{transactions:i.transactions,baseCurrency:i.baseCurrency,onDelete:f=>R({...i,transactions:i.transactions.filter(w=>w.id!==f)}),onAdd:()=>y(!0),getTransactionValue:_,customCategories:i.customCategories}),o==="recurring"&&e.jsx(ot,{data:i,onUpdate:R,baseCurrency:i.baseCurrency,exchangeRates:k}),o==="goals"&&e.jsx(it,{data:i,onUpdate:R,baseCurrency:i.baseCurrency,convertAmount:$,exchangeRates:k}),o==="settings"&&e.jsx(ct,{data:i,onUpdateData:R,onVaultDeleted:()=>{m(!1),p(!1),localStorage.clear()},exchangeRates:k})]})}),e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-slate-950 border-t border-slate-800 flex justify-around p-4 z-20 pb-8",children:[e.jsx("button",{onClick:()=>n("dashboard"),className:`${o==="dashboard"?"text-white":"text-slate-500"}`,children:e.jsx(oe,{})}),e.jsx("button",{onClick:()=>n("transactions"),className:`${o==="transactions"?"text-white":"text-slate-500"}`,children:e.jsx(ie,{})}),e.jsx("button",{onClick:()=>y(!0),className:"bg-brand-600 text-white p-3 rounded-full -mt-10 border-4 border-slate-950 shadow-lg shadow-brand-900/40",children:e.jsx(te,{})}),e.jsx("button",{onClick:()=>n("recurring"),className:`${o==="recurring"?"text-white":"text-slate-500"}`,children:e.jsx(fe,{})}),e.jsx("button",{onClick:()=>n("goals"),className:`${o==="goals"?"text-white":"text-slate-500"}`,children:e.jsx(ge,{})})]}),S&&e.jsx(dt,{onClose:()=>y(!1),onSave:f=>{R({...i,transactions:[f,...i.transactions]}),y(!1)},baseCurrency:i.baseCurrency,exchangeRates:k,customCategories:i.customCategories})]}):e.jsxs("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 inset-0 bg-gradient-to-b from-slate-900 to-slate-950"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-brand-900/10 rounded-full blur-3xl pointer-events-none"}),e.jsxs("div",{className:"w-full max-w-md bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl relative z-10 animate-in fade-in zoom-in-95 duration-500",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-brand-600 rounded-2xl shadow-lg shadow-brand-500/20",children:e.jsx(ne,{className:"w-10 h-10 text-white"})})}),e.jsx("div",{className:"flex justify-center mb-2",children:h?e.jsx("h1",{className:"text-2xl font-bold text-center text-white truncate max-w-[300px]",children:h}):e.jsx("h1",{className:"text-2xl font-bold text-center text-white",children:"Vault Locked"})}),e.jsx("p",{className:"text-slate-400 text-center mb-8 text-sm",children:h?"Enter your master password to access your vault.":"Enter your master password to decrypt."}),e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{type:"password",value:c,onChange:f=>d(f.target.value),placeholder:"Master Password",className:"w-full bg-slate-950 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 focus:border-transparent transition-all placeholder:text-slate-600",autoFocus:!0})}),j&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-900/20 py-2 rounded-lg border border-red-900/50",children:j}),e.jsx("button",{type:"submit",disabled:!c||a,className:"w-full bg-brand-600 hover:bg-brand-500 text-white font-semibold py-3 rounded-xl transition-all shadow-lg shadow-brand-600/20 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center",children:a?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):"Unlock Vault"})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-slate-800 text-center",children:e.jsx("button",{onClick:()=>N(!0),className:"text-xs text-slate-500 hover:text-red-400 transition-colors",children:"Reset Vault (Delete Data)"})}),L&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/80 backdrop-blur-md",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-8 w-full max-w-sm shadow-2xl animate-in zoom-in-95 duration-200",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-red-500/10 rounded-2xl",children:e.jsx(se,{className:"w-8 h-8 text-red-500"})})}),e.jsx("h3",{className:"text-xl font-bold text-white text-center mb-2",children:"Reset Entire Vault?"}),e.jsxs("p",{className:"text-slate-400 text-sm text-center mb-8",children:["This will perform a hard reset. All your data will be"," ",e.jsx("strong",{children:"permanently deleted"}),". This action cannot be undone."]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>{U(),N(!1)},className:"w-full bg-red-600 hover:bg-red-500 text-white py-3.5 rounded-xl font-bold transition-all shadow-lg shadow-red-600/20",children:"Yes, Delete Everything"}),e.jsx("button",{onClick:()=>N(!1),className:"w-full bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-xl font-medium transition-colors",children:"Cancel"})]})]})})]})]}):e.jsx(at,{password:c,setPassword:d,onCreate:O,isLoading:a,error:j,onImportSuccess:()=>{m(!0),u(localStorage.getItem(ee)||"")}})}const at=({password:t,setPassword:m,onCreate:r,isLoading:p,error:c,onImportSuccess:d})=>{const[a,x]=b.useState("create"),[j,l]=b.useState(null),h=u=>{const i=u.target.files?.[0];if(l(null),!i)return;if(i.size===0){l("Import Failed: The selected file is empty."),u.target.value="";return}const s=new FileReader;s.onload=k=>{try{const D=(k.target?.result||"").trim();if(!D){l("Import Failed: File content is empty.");return}let o=!1;try{const n=JSON.parse(D);if(n.transactions&&Array.isArray(n.transactions)&&!n.salt){l("Security Error: Importing unencrypted raw JSON data is not allowed."),u.target.value="";return}n.salt&&n.data&&(localStorage.setItem(K,n.salt),localStorage.setItem(H,n.data),o=!0)}catch{}if(!o&&!j&&D.includes("|")){const n=D.split("|");if(n.length>=2){const[S,y]=n;S&&y&&(localStorage.setItem(K,S),localStorage.setItem(H,y),localStorage.setItem(K,S),localStorage.setItem(H,y),o=!0)}}o?d():j||l("Invalid backup file format. Expected an encrypted .vf file.")}catch{l("Import Failed: An unexpected error occurred.")}u.target.value=""},s.readAsText(i)};return e.jsxs("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 inset-0 bg-gradient-to-b from-slate-900 to-slate-950"}),e.jsxs("div",{className:"w-full max-w-lg bg-slate-900 border border-slate-800 rounded-3xl p-8 shadow-2xl relative z-10 animate-in fade-in slide-in-from-bottom-8 duration-500",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-2xl shadow-xl shadow-brand-500/20",children:e.jsx(ne,{className:"w-12 h-12 text-white"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome to Vault Finance"}),e.jsx("p",{className:"text-slate-400",children:"Secure, offline, personal finance tracking."})]}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl mb-8 border border-slate-800",children:[e.jsx("button",{onClick:()=>{x("create"),l(null)},className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-all ${a==="create"?"bg-brand-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Create New Vault"}),e.jsx("button",{onClick:()=>{x("import"),l(null)},className:`flex-1 py-2.5 rounded-lg text-sm font-medium transition-all ${a==="import"?"bg-brand-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Import Backup"})]}),a==="create"?e.jsx(rt,{onCreate:r,isLoading:p,error:c}):e.jsxs("div",{className:"animate-in fade-in duration-300 text-center py-8 bg-slate-950/50 rounded-2xl border border-slate-800 border-dashed",children:[e.jsx(ie,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white font-medium mb-1",children:"Upload Backup File"}),e.jsx("p",{className:"text-slate-500 text-sm mb-6",children:"Restore a .vf encrypted backup file."}),j&&e.jsx("div",{className:"mb-6 mx-4 p-3 bg-red-900/20 border border-red-900/50 rounded-xl text-sm text-red-400",children:j}),e.jsxs("label",{className:"bg-white hover:bg-slate-200 text-black px-6 py-3 rounded-xl font-bold cursor-pointer transition-all inline-block",children:["Select File",e.jsx("input",{type:"file",onChange:h,className:"hidden",accept:".json,.vf"})]})]})]})]})},rt=({onCreate:t,isLoading:m,error:r})=>{const[p,c]=b.useState(""),[d,a]=b.useState(""),x=j=>{t(j,p,d)};return e.jsxs("form",{onSubmit:x,className:"space-y-4 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1.5 uppercase tracking-wider",children:"Vault Name"}),e.jsx("input",{type:"text",name:"username",value:p,maxLength:21,onChange:j=>c(j.target.value),className:"w-full bg-slate-900 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",placeholder:"e.g. My Vault",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1.5 uppercase tracking-wider",children:"Set Master Password"}),e.jsx("input",{type:"password",value:d,onChange:j=>a(j.target.value),placeholder:"Create a strong password",className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 focus:border-transparent transition-all placeholder:text-slate-600"}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Your data will be encrypted with this password."})]}),r&&e.jsx("p",{className:"text-red-400 text-sm text-center bg-red-900/20 py-2 rounded-lg border border-red-900/50",children:r}),e.jsx("button",{type:"submit",disabled:!d||!p.trim()||m,className:"w-full bg-white hover:bg-slate-200 text-black font-bold py-3.5 rounded-xl transition-all shadow-lg mt-2 disabled:opacity-50",children:m?"Creating...":"Create Vault"})]})},Z=({active:t,onClick:m,icon:r,label:p})=>e.jsxs("button",{onClick:m,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 border text-sm font-medium ${t?"bg-slate-900 border-slate-800 text-white shadow-sm":"bg-transparent border-transparent text-slate-500 hover:text-slate-300 hover:bg-slate-900/50"}`,children:[Ae.cloneElement(r,{className:`w-5 h-5 ${t?"text-brand-400":"text-current"}`}),e.jsx("span",{className:"",children:p})]}),lt=({balance:t,totalIncome:m,totalExpense:r,baseCurrency:p,expensesByCategory:c,incomeByCategory:d,monthlyData:a,recentTransactions:x,onAddTransaction:j,onViewAll:l})=>e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-brand-600 to-indigo-700 rounded-3xl p-8 text-white border border-brand-500/20 relative overflow-hidden shadow-2xl shadow-brand-900/30 group transition-all duration-500 hover:scale-[1.01] hover:shadow-brand-900/50",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-32 group-hover:bg-white/15 transition-colors duration-500"}),e.jsx("p",{className:"text-brand-100 font-medium mb-2 relative z-10 text-sm uppercase tracking-wider flex items-center gap-2",children:"Total Balance"}),e.jsx("h2",{className:"text-4xl lg:text-5xl font-bold relative z-10 tracking-tight text-white drop-shadow-sm break-words leading-tight",children:Q(t,p)}),e.jsxs("button",{onClick:j,className:"mt-8 bg-white/10 hover:bg-white/20 backdrop-blur-md border border-white/20 py-2.5 px-5 rounded-xl text-sm font-semibold transition-all flex items-center gap-2 relative z-10 hover:scale-105 active:scale-95",children:[e.jsx(te,{className:"w-4 h-4"})," Add Transaction"]}),e.jsxs("div",{className:"mt-8 grid grid-cols-[4.5fr_5.5fr] gap-4 relative z-10 border-t border-white/10 pt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-brand-100/60 uppercase tracking-wider mb-1",children:"Total Income"}),e.jsx("span",{className:"text-xl font-bold text-emerald-300",children:Q(m,p)})]}),e.jsxs("div",{className:"flex flex-col border-l border-white/10 pl-4",children:[e.jsx("span",{className:"text-xs text-brand-100/60 uppercase tracking-wider mb-1",children:"Total Expenses"}),e.jsx("span",{className:"text-xl font-bold text-rose-300",children:Q(r,p)})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-6 text-slate-100 flex items-center gap-2",children:["Analytics"," ",e.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-950 px-2 py-0.5 rounded-full border border-slate-800",children:"Last 6 Months"})]}),e.jsx("div",{style:{width:"100%",height:300},children:e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:a,children:[e.jsx(Ue,{strokeDasharray:"3 3",stroke:"#27272a",vertical:!1}),e.jsx(Be,{dataKey:"name",stroke:"#6b7280",tickLine:!1,axisLine:!1,fontSize:12,dy:10}),e.jsx(ze,{stroke:"#6b7280",tickLine:!1,axisLine:!1,fontSize:12,tickFormatter:h=>`${h/1e3}k`}),e.jsx(he,{formatter:h=>B(h),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},cursor:{fill:"rgba(255,255,255,0.03)"}}),e.jsx(je,{dataKey:"Income",fill:"#34d399",radius:[4,4,0,0],maxBarSize:40}),e.jsx(je,{dataKey:"Expense",fill:"#f87171",radius:[4,4,0,0],maxBarSize:40})]})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1.5fr_1fr] gap-6",children:[e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm flex flex-col h-[420px] transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Financial Composition"})}),e.jsxs("div",{className:"flex-1 w-full min-h-0 relative grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-xs font-bold text-rose-400 mb-2 uppercase tracking-wider",children:"Expense"}),e.jsx("div",{className:"flex-1 w-full relative min-h-[150px]",children:c.length>0?e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(we,{children:[e.jsx(ye,{data:c,cx:"50%",cy:"50%",innerRadius:60,outerRadius:85,paddingAngle:5,dataKey:"value",stroke:"none",children:c.map((h,u)=>e.jsx(Ne,{fill:re[u%re.length]},`cell-${u}`))}),e.jsx(he,{formatter:h=>Q(h,p),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},itemStyle:{color:"#fff"}})]})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20",children:e.jsx(oe,{className:"w-8 h-8"})})})]}),e.jsxs("div",{className:"flex flex-col items-center border-l border-slate-800 pl-2",children:[e.jsx("p",{className:"text-xs font-bold text-emerald-400 mb-2 uppercase tracking-wider",children:"Income"}),e.jsx("div",{className:"flex-1 w-full relative min-h-[150px]",children:d.length>0?e.jsx(me,{width:"100%",height:"100%",children:e.jsxs(we,{children:[e.jsx(ye,{data:d,cx:"50%",cy:"50%",innerRadius:60,outerRadius:85,paddingAngle:5,dataKey:"value",stroke:"none",children:d.map((h,u)=>e.jsx(Ne,{fill:le[u%le.length]},`cell-${u}`))}),e.jsx(he,{formatter:h=>Q(h,p),contentStyle:{backgroundColor:"#1c1c1e",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},itemStyle:{color:"#fff"}})]})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center opacity-20",children:e.jsx(oe,{className:"w-8 h-8"})})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2 justify-center max-h-16 overflow-y-auto",children:[c.slice(0,4).map((h,u)=>e.jsxs("span",{className:"text-[10px] bg-slate-950 text-slate-400 px-2 py-1 rounded-full border border-slate-800 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:re[u%re.length]}}),h.name]},`exp-${u}`)),d.slice(0,4).map((h,u)=>e.jsxs("span",{className:"text-[10px] bg-slate-950 text-slate-400 px-2 py-1 rounded-full border border-slate-800 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:le[u%le.length]}}),h.name]},`inc-${u}`))]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 flex flex-col shadow-sm h-[420px] transition-all duration-300 hover:border-slate-700 hover:shadow-xl hover:shadow-black/20 hover:-translate-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Recent Activity"}),e.jsx("button",{onClick:l,className:"text-xs text-brand-400 hover:text-brand-300 font-medium transition-colors",children:"View All"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 [&::-webkit-scrollbar]:hidden",children:[x.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[e.jsx(ie,{className:"w-8 h-8 mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No recent activity."})]}),x.length>0&&e.jsx("div",{className:"space-y-3",children:x.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3.5 hover:bg-slate-950 rounded-2xl transition-all border border-transparent hover:border-slate-800 group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg ${h.type==="income"?"bg-emerald-500/10 text-emerald-500":"bg-rose-500/10 text-rose-500"}`,children:h.category.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-200 text-sm group-hover:text-white transition-colors",children:h.category}),e.jsx("p",{className:"text-xs text-slate-500",children:new Date(h.date).toLocaleDateString()})]})]}),e.jsxs("span",{className:`font-semibold text-sm ${h.type==="income"?"text-emerald-400":"text-slate-400"}`,children:[h.type==="income"?"+":"-",B(h.amount)," ",e.jsx("span",{className:"text-[10px] text-slate-500",children:h.currency})]})]},h.id))})]})]})]})]}),nt=({transactions:t,baseCurrency:m,onDelete:r,onAdd:p,getTransactionValue:c,customCategories:d})=>{const[a,x]=b.useState(""),[j,l]=b.useState("All"),[h,u]=b.useState("All"),[i,s]=b.useState("All"),k=b.useMemo(()=>{const o=t.map(n=>n.category);return Array.from(new Set(o)).sort()},[t]),D=b.useMemo(()=>t.filter(o=>{const n=o.description?.toLowerCase().includes(a.toLowerCase())||o.category.toLowerCase().includes(a.toLowerCase()),S=j==="All"||o.category===j,y=h==="All"||o.type===h;let L=!0;if(i!=="All"){const N=parseInt(i),T=new Date;T.setDate(T.getDate()-N),T.setHours(0,0,0,0),L=new Date(o.date)>=T}return n&&S&&y&&L}),[t,a,j,h,i]);return e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Transactions"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Manage your income and expenses."})]}),e.jsxs("button",{onClick:p,className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(te,{className:"w-4 h-4"})," New"]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-4 flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 w-full",children:[e.jsx(tt,{className:"absolute left-3 top-3 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:a,onChange:o=>x(o.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-9 pr-4 py-2.5 text-sm text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50"})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0",children:[e.jsxs("select",{value:j,onChange:o=>l(o.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Categories"}),k.map(o=>e.jsx("option",{value:o,children:o},o))]}),e.jsxs("select",{value:h,onChange:o=>u(o.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Types"}),e.jsx("option",{value:E.INCOME,children:"Income"}),e.jsx("option",{value:E.EXPENSE,children:"Expense"})]}),e.jsxs("select",{value:i,onChange:o=>s(o.target.value),className:"bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-sm text-slate-300 outline-none focus:ring-1 focus:ring-inset focus:ring-brand-500",children:[e.jsx("option",{value:"All",children:"All Time"}),e.jsx("option",{value:"30",children:"Last 30 Days"}),e.jsx("option",{value:"90",children:"Last 90 Days"}),e.jsx("option",{value:"365",children:"Last Year"})]})]})]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[e.jsx("thead",{className:"bg-slate-950/50 uppercase text-xs font-semibold tracking-wider text-slate-500 border-b border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Amount (Orig)"}),e.jsxs("th",{className:"px-6 py-4 text-right",children:["Value (",m,")"]}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[D.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-slate-500",children:"No transactions found matching your filters."})}),D.map(o=>e.jsxs("tr",{className:"hover:bg-slate-950/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 text-slate-300 font-medium",children:new Date(o.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium border ${o.type==="income"?"bg-emerald-500/10 border-emerald-500/20 text-emerald-400":"bg-rose-500/10 border-rose-500/20 text-rose-400"}`,children:o.category})}),e.jsx("td",{className:"px-6 py-4 text-slate-400 max-w-xs",children:e.jsx("div",{className:"truncate",title:o.description||"",children:o.description||"-"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-medium ${o.type==="income"?"text-emerald-400":"text-slate-400"}`,children:[B(o.amount)," ",e.jsx("span",{className:"text-xs text-slate-600",children:o.currency})]}),e.jsx("td",{className:`px-6 py-4 text-right font-medium ${o.type==="income"?"text-emerald-400":"text-slate-400"}`,children:B(c(o))}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>r(o.id),className:"p-2 text-slate-500 hover:text-rose-400 hover:bg-rose-500/10 rounded-lg transition-all",children:e.jsx(se,{className:"w-4 h-4"})})})]},o.id))]})]})})})]})},ot=({data:t,onUpdate:m,baseCurrency:r,exchangeRates:p})=>{const[c,d]=b.useState(!1),[a,x]=b.useState({frequency:G.MONTHLY,currency:r,category:A.UTILITIES,active:!0,type:E.EXPENSE,exchangeRate:void 0}),j=()=>{const s=new Date;return s.setHours(0,0,0,0),(t.recurring||[]).filter(k=>{const D=new Date(k.nextDueDate);return D.setHours(0,0,0,0),k.active&&D<=s})},l=s=>{const k=s.exchangeRate||(s.currency===r?1:p[s.currency]),D={id:crypto.randomUUID(),amount:s.amount,currency:s.currency,category:s.category,type:s.type||E.EXPENSE,date:new Date().toISOString(),description:`Recurring: ${s.name}`,recordedBaseCurrency:r,exchangeRate:k},o=new Date(s.nextDueDate);s.frequency===G.MONTHLY?o.setMonth(o.getMonth()+1):s.frequency===G.WEEKLY?o.setDate(o.getDate()+7):s.frequency===G.YEARLY&&o.setFullYear(o.getFullYear()+1);const n=t.recurring.map(S=>S.id===s.id?{...S,nextDueDate:o.toISOString()}:S);m({...t,transactions:[D,...t.transactions],recurring:n})},h=()=>{if(!a.name||!a.amount)return;const s={id:crypto.randomUUID(),name:a.name,amount:Number(a.amount),currency:a.currency||r,frequency:a.frequency||G.MONTHLY,category:a.category||A.UTILITIES,nextDueDate:a.nextDueDate||new Date().toISOString(),active:!0,type:a.type||E.EXPENSE,exchangeRate:a.exchangeRate?Number(a.exchangeRate):void 0};m({...t,recurring:[...t.recurring||[],s]}),d(!1),x({frequency:G.MONTHLY,currency:r,category:A.UTILITIES,active:!0,type:E.EXPENSE,exchangeRate:void 0})},u=s=>{const k=Object.values(A).filter(o=>s===E.INCOME?W.includes(o):!W.includes(o)||o===A.OTHER),D=(t.customCategories||[]).filter(o=>o.type===s).map(o=>o.name);return[...k,...D]},i=j();return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Recurring Items"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Automate your regular income and expenses."})]}),e.jsxs("button",{onClick:()=>d(!0),className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(te,{className:"w-4 h-4"})," New"]})]}),i.length>0&&e.jsxs("div",{className:"bg-brand-900/20 border border-brand-500/30 rounded-3xl p-6",children:[e.jsxs("h3",{className:"text-brand-400 font-semibold mb-4 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"})," Due for Approval"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(s=>e.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-4 rounded-xl flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-bold text-white",children:s.name}),e.jsx("span",{className:"text-xs bg-slate-800 text-slate-400 px-2 py-1 rounded",children:new Date(s.nextDueDate).toLocaleDateString()})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:"text-lg font-mono text-slate-200",children:[B(s.amount)," ",s.currency]}),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded uppercase ${s.type===E.INCOME?"text-emerald-400 bg-emerald-500/10":"text-rose-400 bg-rose-500/10"}`,children:s.type||"EXPENSE"})]}),s.exchangeRate&&e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Locked Rate: ",s.exchangeRate]})]}),e.jsx("button",{onClick:()=>l(s),className:"mt-4 w-full bg-brand-600 hover:bg-brand-500 text-white py-2 rounded-lg text-sm font-medium transition-colors",children:"Approve & Create"})]},s.id))})]}),e.jsx("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm text-slate-400",children:[e.jsx("thead",{className:"bg-slate-950/50 uppercase text-xs font-semibold tracking-wider text-slate-500 border-b border-slate-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Name"}),e.jsx("th",{className:"px-6 py-4",children:"Type"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Frequency"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4",children:"Next Due"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800/50",children:[(t.recurring||[]).length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-slate-500",children:"No recurring items defined."})}),(t.recurring||[]).map(s=>e.jsxs("tr",{className:"hover:bg-slate-950/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-white font-medium",children:s.name}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded uppercase border ${s.type===E.INCOME?"text-emerald-400 border-emerald-500/20 bg-emerald-500/10":"text-rose-400 border-rose-500/20 bg-rose-500/10"}`,children:s.type||"EXPENSE"})}),e.jsx("td",{className:"px-6 py-4 text-slate-300",children:s.category}),e.jsx("td",{className:"px-6 py-4 text-slate-400",children:s.frequency}),e.jsxs("td",{className:"px-6 py-4 font-mono",children:[B(s.amount)," ",s.currency,s.exchangeRate&&e.jsxs("span",{className:"block text-[10px] text-slate-600",children:["@",s.exchangeRate]})]}),e.jsx("td",{className:"px-6 py-4",children:new Date(s.nextDueDate).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>m({...t,recurring:t.recurring.filter(k=>k.id!==s.id)}),className:"text-slate-500 hover:text-red-400",children:e.jsx(se,{className:"w-4 h-4"})})})]},s.id))]})]})}),c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"New Recurring Item"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",placeholder:"Name (e.g. Salary, Netflix)",value:a.name||"",onChange:s=>x({...a,name:s.target.value})}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{type:"button",onClick:()=>x({...a,type:E.EXPENSE,category:A.UTILITIES}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${a.type===E.EXPENSE?"bg-rose-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Expense"}),e.jsx("button",{type:"button",onClick:()=>x({...a,type:E.INCOME,category:A.INCOME}),className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${a.type===E.INCOME?"bg-emerald-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Income"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block",children:"Category"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto",children:u(a.type).map(s=>e.jsx("button",{type:"button",onClick:()=>x({...a,category:s}),className:`px-3 py-2 rounded-lg text-xs font-medium border transition-all text-left truncate ${a.category===s?"bg-slate-800 border-brand-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`,children:s},s))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",type:"number",placeholder:"Amount",value:a.amount||"",onChange:s=>x({...a,amount:Number(s.target.value)})}),e.jsx("select",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:a.currency,onChange:s=>x({...a,currency:s.target.value}),children:Object.values(q).map(s=>e.jsx("option",{value:s,children:s},s))})]}),a.currency!==r&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Expected Exchange Rate (1 ",a.currency," = ?"," ",r,")"]}),e.jsx("input",{type:"number",step:"0.0001",placeholder:`Current: ${p[a.currency||"USD"]||1}`,value:a.exchangeRate||"",onChange:s=>x({...a,exchangeRate:Number(s.target.value)}),className:"w-full bg-transparent text-white focus:outline-none"}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:"Leave blank to use dynamic rate at time of approval."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:a.frequency,onChange:s=>x({...a,frequency:s.target.value}),children:Object.values(G).map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsxs("div",{className:"flex-1 relative group/date",children:[e.jsx("input",{type:"date",className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-4 pr-10 py-3 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 transition-all cursor-pointer hover:border-slate-700 hover:bg-slate-900/50",value:a.nextDueDate?a.nextDueDate.split("T")[0]:"",onChange:s=>x({...a,nextDueDate:new Date(s.target.value).toISOString()})}),e.jsx(Re,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-brand-400 group-hover/date:text-brand-300 transition-colors pointer-events-none z-10"})]})]}),e.jsx("button",{onClick:h,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:"Save Recurring Item"}),e.jsx("button",{onClick:()=>d(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})})]})},it=({data:t,onUpdate:m,baseCurrency:r,convertAmount:p,exchangeRates:c})=>{const[d,a]=b.useState(!1),[x,j]=b.useState(!1),[l,h]=b.useState(null),[u,i]=b.useState(""),[s,k]=b.useState(""),[D,o]=b.useState(""),[n,S]=b.useState(null),[y,L]=b.useState({currency:r,color:"#60a5fa"}),N=g=>{h(g),i(""),k(""),o(""),S(null),j(!0)},T=()=>{if(!l||!u)return;const g=parseFloat(u);if(isNaN(g)||g<=0){S("Please enter a valid positive amount.");return}const V=l.targetAmount-l.currentAmount;if(g>V){S(`You cannot add more than the remaining amount (${B(V)} ${l.currency}).`);return}const P=D?parseFloat(D):l.currency===r?1:c[l.currency]||1,U={id:crypto.randomUUID(),amount:g,currency:l.currency,type:E.EXPENSE,category:A.SAVINGS,date:new Date().toISOString(),description:s.trim()?`Goal: ${s}`:`Goal: Contribution to ${l.name}`,recordedBaseCurrency:r,exchangeRate:P,goalId:l.id},M=t.goals.map(R=>R.id===l.id?{...R,currentAmount:R.currentAmount+g}:R);m({...t,transactions:[U,...t.transactions],goals:M}),j(!1)},O=()=>{if(!y.name||!y.targetAmount)return;const g={id:crypto.randomUUID(),name:y.name,targetAmount:Number(y.targetAmount),currentAmount:0,currency:y.currency||r,color:y.color||"#60a5fa"};m({...t,goals:[...t.goals||[],g]}),a(!1),L({currency:r,color:"#60a5fa"})};return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Savings Goals"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Visualize your targets."})]}),e.jsxs("button",{onClick:()=>a(!0),className:"bg-white hover:bg-slate-200 text-black px-5 py-2.5 rounded-xl text-sm font-semibold flex items-center gap-2 transition-all shadow-lg",children:[e.jsx(te,{className:"w-4 h-4"})," New Goal"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(t.goals||[]).length===0?e.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center p-12 text-center bg-slate-900 border border-slate-800 rounded-3xl border-dashed",children:[e.jsx("div",{className:"p-4 bg-slate-800 rounded-full mb-4",children:e.jsx(ge,{className:"w-8 h-8 text-slate-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"No Goals Yet"}),e.jsx("p",{className:"text-slate-400 text-sm max-w-xs mb-6",children:"Create a savings goal to track your progress for things like a vacation, new car, or emergency fund."}),e.jsx("button",{onClick:()=>a(!0),className:"bg-brand-600 hover:bg-brand-500 text-white px-6 py-2.5 rounded-xl text-sm font-bold transition-all hover:scale-105 active:scale-95 shadow-lg shadow-brand-500/20",children:"Create your first goal"})]}):(t.goals||[]).map(g=>{const V=Math.min(100,g.currentAmount/g.targetAmount*100);return e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 shadow-sm relative overflow-hidden transition-all duration-300 hover:border-slate-700 hover:shadow-2xl hover:-translate-y-1 group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[e.jsx("h3",{className:"font-bold text-lg text-white group-hover:text-brand-300 transition-colors",children:g.name}),e.jsx("button",{onClick:()=>{const U=g.currentAmount>=g.targetAmount?t.transactions:t.transactions.filter(M=>M.goalId!==g.id);m({...t,goals:t.goals.filter(M=>M.id!==g.id),transactions:U})},className:"text-slate-600 hover:text-red-400 transition-colors bg-slate-950/50 p-2 rounded-lg hover:bg-red-500/10",children:e.jsx(se,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"mb-4 relative z-10",children:e.jsxs("p",{className:"text-3xl font-bold text-white",children:[B(g.currentAmount)," ",e.jsxs("span",{className:"text-sm font-normal text-slate-500",children:["/ ",B(g.targetAmount)," ",g.currency]})]})}),e.jsx("div",{className:"w-full bg-slate-800 h-3 rounded-full overflow-hidden relative z-10 mb-6",children:e.jsx("div",{className:"h-full transition-all duration-1000 ease-out relative overflow-hidden",style:{width:`${V}%`,backgroundColor:g.color},children:e.jsx("div",{className:"absolute inset-0 bg-white/20 animate-[shimmer_2s_infinite]"})})}),e.jsx("button",{onClick:()=>N(g),className:"w-full bg-slate-800 hover:bg-slate-700 text-white py-3 rounded-xl font-medium transition-colors relative z-10 border border-slate-700",children:"+ Add Funds"}),e.jsx("div",{className:"absolute -bottom-10 -right-10 w-32 h-32 rounded-full opacity-25 blur-2xl pointer-events-none",style:{backgroundColor:g.color}})]},g.id)})}),d&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"New Goal"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",placeholder:"Goal Name (e.g. Japan Trip)",value:y.name||"",onChange:g=>L({...y,name:g.target.value})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",type:"number",placeholder:"Target Amount",value:y.targetAmount||"",onChange:g=>L({...y,targetAmount:Number(g.target.value)})}),e.jsx("select",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3 text-white",value:y.currency,onChange:g=>L({...y,currency:g.target.value}),children:Object.values(q).map(g=>e.jsx("option",{value:g,children:g},g))})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("label",{className:"text-sm text-slate-400",children:"Color:"}),e.jsx("input",{type:"color",className:"bg-transparent h-10 w-10 cursor-pointer",value:y.color,onChange:g=>L({...y,color:g.target.value})})]}),e.jsx("button",{onClick:O,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:"Create Goal"}),e.jsx("button",{onClick:()=>a(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})}),x&&l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-sm shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Add Funds"}),e.jsxs("p",{className:"text-slate-400 text-sm mb-4",children:["Adding to ",e.jsx("strong",{children:l.name})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white pl-12",type:"number",placeholder:"0.00",value:u,onChange:g=>i(g.target.value),autoFocus:!0}),e.jsx("span",{className:"absolute left-3 top-3 text-slate-500 font-medium",children:l.currency})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:"w-full bg-slate-950 border border-slate-800 rounded-xl p-3 text-white text-sm",type:"text",placeholder:"Note (Optional)",value:s,onChange:g=>k(g.target.value)})}),l.currency!==r&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Exchange Rate (1 ",l.currency," = ? ",r,")"]}),e.jsx("div",{className:"flex gap-2 items-center",children:e.jsx("input",{type:"number",step:"any",value:D,onChange:g=>o(g.target.value),placeholder:`${c[l.currency]||"1.0"}`,className:"flex-1 bg-transparent text-white focus:outline-none font-mono text-sm"})}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:D?`Using custom rate: 1 ${l.currency} = ${D} ${r}`:`Using market rate: 1 ${l.currency} = ${c[l.currency]||1} ${r}`})]}),n&&e.jsx("p",{className:"text-red-400 text-xs bg-red-900/20 p-2 rounded-lg border border-red-900/30",children:n}),e.jsx("button",{onClick:T,className:"w-full bg-brand-600 text-white py-3 rounded-xl font-bold mt-6",children:"Confirm Deposit"}),e.jsx("button",{onClick:()=>j(!1),className:"w-full text-slate-500 py-2 hover:text-red-400 transition-colors",children:"Cancel"})]})]})})]})},ct=({data:t,onUpdateData:m,onVaultDeleted:r,exchangeRates:p})=>{const[c,d]=b.useState(""),[a,x]=b.useState(E.EXPENSE),[j,l]=b.useState(null),[h,u]=b.useState(!1),[i,s]=b.useState("csv"),k=()=>{if(!c.trim())return;const n=Object.values(A),S=(t.customCategories||[]).map(L=>L.name);if(n.includes(c)||S.includes(c)){alert("Category already exists");return}const y={name:c.trim(),type:a};m({...t,customCategories:[...t.customCategories||[],y]}),d("")},D=n=>{m({...t,customCategories:(t.customCategories||[]).filter(S=>S.name!==n)})},o=()=>{if(l(null),!(t.transactions.length>0||(t.goals||[]).length>0||(t.recurring||[]).length>0)){l({type:"error",text:"Export Failed: Vault is empty. Add some data first."});return}const S=localStorage.getItem(K),y=localStorage.getItem(H);if(!S||!y){l({type:"error",text:"Export Failed: No secure data found to export."});return}const L={salt:S,data:y,version:"1.0",timestamp:new Date().toISOString()},N=JSON.stringify(L),T=new Blob([N],{type:"application/json"}),O=URL.createObjectURL(T),g=document.createElement("a");g.href=O;const V=t.vaultName?t.vaultName.replace(/[^a-z0-9]/gi,"_").toLowerCase():"vault",P=new Date,U=P.toISOString().split("T")[0],M=P.toTimeString().split(" ")[0].replace(/:/g,"");g.download=`${V}_backup_${U}_${M}.vf`,document.body.appendChild(g),g.click(),document.body.removeChild(g),l({type:"success",text:"Backup downloaded successfully."}),setTimeout(()=>l(null),3e3)};return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Settings"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Configure your vault."})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Preferences"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Vault Name"}),e.jsx("input",{type:"text",name:"username",maxLength:21,value:t.vaultName||"",onChange:n=>{const S=n.target.value;m({...t,vaultName:S}),S.trim()&&localStorage.setItem(ee,S)},className:`w-full bg-slate-950 border rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50 ${t.vaultName?.trim()?"border-slate-800 focus:border-transparent":"border-red-500/50 focus:border-red-500"}`,placeholder:"Name your vault"}),!t.vaultName?.trim()&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:"Vault name is required."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Base Currency"}),e.jsx("select",{value:t.baseCurrency,onChange:n=>m({...t,baseCurrency:n.target.value}),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",children:Object.values(q).map(n=>e.jsx("option",{value:n,children:n},n))}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"All transactions will be converted to this currency for aggregation."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Auto Lock Timer"}),e.jsxs("select",{value:t.autoLockDuration,onChange:n=>m({...t,autoLockDuration:Number(n.target.value)}),className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-brand-500/50",children:[e.jsx("option",{value:6e4,children:"1 Minute"}),e.jsx("option",{value:3e5,children:"5 Minutes"}),e.jsx("option",{value:9e5,children:"15 Minutes"}),e.jsx("option",{value:18e5,children:"30 Minutes"}),e.jsx("option",{value:0,children:"Never"})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Automatically lock vault after inactivity."})]})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Custom Categories (Tags)"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{onClick:()=>x(E.EXPENSE),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${a===E.EXPENSE?"bg-rose-500/20 text-rose-400":"text-slate-500"}`,children:"Expense"}),e.jsx("button",{onClick:()=>x(E.INCOME),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all ${a===E.INCOME?"bg-emerald-500/20 text-emerald-400":"text-slate-500"}`,children:"Income"})]}),e.jsx("input",{value:c,onChange:n=>d(n.target.value),placeholder:"New Tag Name",className:"flex-1 bg-slate-950 border border-slate-800 rounded-xl px-3 text-white text-sm"}),e.jsx("button",{onClick:k,className:"bg-brand-600 hover:bg-brand-500 text-white px-4 rounded-xl text-sm font-bold",children:"Add"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(t.customCategories||[]).filter(n=>n.type===a).map(n=>e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg border border-slate-700 bg-slate-800 text-sm text-slate-300",children:[n.name,e.jsx("button",{onClick:()=>D(n.name),className:"text-slate-500 hover:text-red-400",children:e.jsx(se,{className:"w-3 h-3"})})]},n.name)),Object.values(A).filter(n=>a===E.INCOME?W.includes(n):!W.includes(n)||n===A.OTHER).map(n=>e.jsx("span",{className:"px-3 py-1.5 rounded-lg border border-slate-800 bg-slate-950 text-sm text-slate-500 cursor-not-allowed",title:"Default Category",children:n},n))]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Data Management"}),j&&e.jsx("div",{className:`mb-4 px-4 py-3 rounded-xl border text-sm ${j.type==="error"?"bg-red-900/20 border-red-900/50 text-red-400":"bg-emerald-900/20 border-emerald-900/50 text-emerald-400"}`,children:j.text}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-slate-950 rounded-xl border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:"Export Transactions"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Download history as CSV or Excel."})]}),e.jsxs("div",{className:"flex bg-slate-900 border border-slate-800 rounded-lg p-1 w-fit mb-2",children:[e.jsx("button",{onClick:()=>s("csv"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${i==="csv"?"bg-slate-700 text-white shadow-sm":"text-slate-500 hover:text-slate-300"}`,children:"CSV"}),e.jsx("button",{onClick:()=>s("excel"),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${i==="excel"?"bg-emerald-600/20 text-emerald-400 shadow-sm":"text-slate-500 hover:text-slate-300"}`,children:"Excel"})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[{label:"Last 15 Days",val:15},{label:"Last 1 Month",val:30},{label:"Last 3 Months",val:90},{label:"Last 6 Months",val:180},{label:"Last 1 Year",val:365},{label:"All Time",val:"all"}].map(n=>e.jsx("button",{onClick:()=>{l(null);const S=t.transactions||[];if(S.length===0){l({type:"error",text:"Export Failed: No transactions to export."});return}let y=S;if(n.val!=="all"){const R=Number(n.val),$=new Date;$.setDate($.getDate()-R),$.setHours(0,0,0,0),y=S.filter(_=>new Date(_.date)>=$)}if(y.length===0){l({type:"error",text:"Export Failed: No transactions found in this range."});return}const L="\uFEFF",N=i==="excel"?"	":",",T=i==="excel"?"xls":"csv",O=["Date","Type","Category","Description","Amount","Currency"],g=y.map(R=>{const $=_=>`"${(_||"").replace(/"/g,'""')}"`;return[new Date(R.date).toLocaleDateString(),R.type,$(R.category),$(R.description||""),R.amount,R.currency].join(N)}),V=L+[O.join(N),...g].join(`
`),P=new Blob([V],{type:i==="excel"?"application/vnd.ms-excel;charset=utf-8":"text/csv;charset=utf-8"}),U=URL.createObjectURL(P),M=document.createElement("a");M.href=U,M.download=`transactions_${n.val==="all"?"all_time":n.val+"_days"}_${new Date().toISOString().split("T")[0]}.${T}`,document.body.appendChild(M),M.click(),document.body.removeChild(M),l({type:"success",text:`Successfully exported ${y.length} transactions (${i.toUpperCase()}).`}),setTimeout(()=>l(null),3e3)},className:"px-3 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-medium transition-colors border border-slate-700 hover:border-slate-600 hover:text-brand-300",children:n.label},n.label))})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:"Export Data"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Download an encrypted backup file (.vf)."})]}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-sm font-medium transition-colors",children:"Download"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-red-900/10 rounded-xl border border-red-900/30",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-red-400 font-medium",children:"Delete Vault"}),e.jsx("p",{className:"text-sm text-red-400/60",children:"Permanently delete all data and reset."})]}),e.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg text-sm font-medium transition-colors",children:"Delete"})]})]})]})]}),h&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-2xl p-6 w-full max-w-sm shadow-2xl animate-in zoom-in-95 duration-200",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Delete Vault?"}),e.jsx("p",{className:"text-slate-400 text-sm mb-6",children:"This will permanently erase all your financial data and reset the application. This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u(!1),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white py-2.5 rounded-xl font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>{r(),u(!1)},className:"flex-1 bg-red-600 hover:bg-red-500 text-white py-2.5 rounded-xl font-medium transition-colors",children:"Delete Forever"})]})]})})]})},dt=({onClose:t,onSave:m,baseCurrency:r,exchangeRates:p,customCategories:c})=>{const[d,a]=b.useState(""),[x,j]=b.useState(r),[l,h]=b.useState(E.EXPENSE),[u,i]=b.useState(A.FOOD),[s,k]=b.useState(new Date().toISOString().split("T")[0]),[D,o]=b.useState(""),[n,S]=b.useState(""),y=b.useMemo(()=>{const N=Object.values(A).filter(O=>l===E.INCOME?W.includes(O):!W.includes(O)||O===A.OTHER),T=(c||[]).filter(O=>O.type===l).map(O=>O.name);return[...N,...T]},[l,c]);b.useEffect(()=>{y.includes(u)||i(y[0]||"")},[l,y]),b.useEffect(()=>{S("")},[x]);const L=N=>{if(N.preventDefault(),!d)return;const T=n?parseFloat(n):x===r?1:p[x]||1,O={id:crypto.randomUUID(),amount:parseFloat(d),currency:x,type:l,category:u,date:new Date(s).toISOString(),description:D,recordedBaseCurrency:r,exchangeRate:T};m(O)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-3xl p-6 w-full max-w-md shadow-2xl scale-100 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"New Transaction"}),e.jsx("button",{onClick:t,className:"text-slate-500 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",value:d,onChange:N=>a(N.target.value),placeholder:"0.00",className:"w-full bg-slate-950 border border-slate-800 rounded-2xl px-4 py-3 text-2xl font-bold text-white placeholder:text-slate-700 focus:outline-none focus:ring-2 focus:ring-brand-500/50",autoFocus:!0}),e.jsx("div",{className:"absolute right-2 top-2 bottom-2",children:e.jsx("select",{value:x,onChange:N=>j(N.target.value),className:"h-full bg-slate-900 border border-slate-800 rounded-xl px-3 text-white text-sm font-medium focus:outline-none focus:ring-1 focus:ring-brand-500",children:Object.values(q).map(N=>e.jsx("option",{value:N,children:N},N))})})]})}),x!==r&&e.jsxs("div",{className:"bg-slate-950 border border-slate-800 rounded-xl p-3",children:[e.jsxs("label",{className:"text-xs text-slate-500 block mb-1",children:["Exchange Rate (1 ",x," = ? ",r,")"]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"number",step:"any",value:n,onChange:N=>S(N.target.value),placeholder:`${p[x]||"1.0"}`,className:"flex-1 bg-transparent text-white focus:outline-none font-mono text-sm"}),e.jsx("button",{type:"button",onClick:()=>S(String(p[x]||1)),className:"text-[10px] text-brand-400 hover:text-brand-300 uppercase font-bold tracking-wider",children:"Auto"})]}),e.jsx("p",{className:"text-[10px] text-slate-600 mt-1",children:n?`Using custom rate: 1 ${x} = ${n} ${r}`:`Using market rate: 1 ${x} = ${p[x]||1} ${r}`})]}),e.jsxs("div",{className:"flex bg-slate-950 p-1 rounded-xl border border-slate-800",children:[e.jsx("button",{type:"button",onClick:()=>{h(E.EXPENSE)},className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${l===E.EXPENSE?"bg-rose-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Expense"}),e.jsx("button",{type:"button",onClick:()=>{h(E.INCOME)},className:`flex-1 py-2.5 rounded-lg text-sm font-bold transition-all ${l===E.INCOME?"bg-emerald-500 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Income"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block",children:"Category"}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-36 overflow-y-auto pr-1 categories-container",children:y.map(N=>e.jsx("button",{type:"button",onClick:()=>i(N),className:`px-3 py-1.5 rounded-lg text-xs font-medium border transition-all ${u===N?"bg-brand-600 border-brand-500 text-white shadow-lg shadow-brand-600/20":"bg-slate-950/50 border-slate-800 text-slate-400 hover:border-slate-700 hover:text-slate-200"}`,children:N},N))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block text-center",children:"Date"}),e.jsxs("div",{className:"relative group/date",children:[e.jsx("input",{type:"date",value:s,onChange:N=>k(N.target.value),className:"w-full bg-slate-950 border border-slate-800 rounded-xl pl-4 pr-10 py-2.5 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 transition-all cursor-pointer hover:border-slate-700 hover:bg-slate-900/50"}),e.jsx(Re,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-brand-400 group-hover/date:text-brand-300 transition-colors pointer-events-none z-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider mb-1.5 block text-center",children:"Note"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",value:D,onChange:N=>o(N.target.value),placeholder:"What is this for?",className:"w-full bg-slate-950 border border-slate-800 rounded-xl px-3 py-2.5 text-white text-sm focus:outline-none focus:ring-1 focus:ring-brand-500 hover:border-slate-700 transition-all"})})]})]}),e.jsx("button",{type:"submit",disabled:!d,className:"w-full bg-white hover:bg-slate-200 text-black font-bold py-3.5 rounded-xl transition-all shadow-lg mt-6 disabled:opacity-50 disabled:cursor-not-allowed",children:"Save Transaction"})]})]})})},xt="modulepreload",ut=function(t){return"/vault_finance/"+t},Ie={},mt=function(m,r,p){let c=Promise.resolve();if(r&&r.length>0){let j=function(l){return Promise.all(l.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),x=a?.nonce||a?.getAttribute("nonce");c=j(r.map(l=>{if(l=ut(l),l in Ie)return;Ie[l]=!0;const h=l.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const i=document.createElement("link");if(i.rel=h?"stylesheet":xt,h||(i.as="script"),i.crossOrigin="",i.href=l,x&&i.setAttribute("nonce",x),document.head.appendChild(i),h)return new Promise((s,k)=>{i.addEventListener("load",s),i.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${l}`)))})}))}function d(a){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=a,window.dispatchEvent(x),!x.defaultPrevented)throw a}return c.then(a=>{for(const x of a||[])x.status==="rejected"&&d(x.reason);return m().catch(d)})};function ht(t={}){const{immediate:m=!1,onNeedRefresh:r,onOfflineReady:p,onRegistered:c,onRegisteredSW:d,onRegisterError:a}=t;let x,j;const l=async(u=!0)=>{await j};async function h(){if("serviceWorker"in navigator){if(x=await mt(async()=>{const{Workbox:u}=await import("./workbox-window.prod.es5.js");return{Workbox:u}},[]).then(({Workbox:u})=>new u("/vault_finance/sw.js",{scope:"/vault_finance/",type:"classic"})).catch(u=>{a?.(u)}),!x)return;x.addEventListener("activated",u=>{(u.isUpdate||u.isExternal)&&window.location.reload()}),x.addEventListener("installed",u=>{u.isUpdate||p?.()}),x.register({immediate:m}).then(u=>{d?d("/vault_finance/sw.js",u):c?.(u)}).catch(u=>{a?.(u)})}}return j=h(),l}ht({immediate:!0,onRegistered(t){},onRegisterError(t){}});const Le=document.getElementById("root");if(!Le)throw new Error("Could not find root element to mount to");const pt=We.createRoot(Le);pt.render(e.jsx(Ae.StrictMode,{children:e.jsx(st,{})}));
